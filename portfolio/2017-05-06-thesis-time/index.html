<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Thesis Time!</title>
<meta name="description" content="Describe your website">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" href="/css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/owl.carousel.css">
<link rel="stylesheet" href="/css/owl.theme.css">


  <link href="/css/style.default.css" rel="stylesheet" id="theme-stylesheet">


<link href="/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="/img/favicon.png">


</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              <div id="sidebar" class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
  <div class="sidebar-content">
    <h1 class="sidebar-heading"><a href="/">Kate Lyons</a></h1>
    
      <p class="sidebar-p">Graduate student in Linguistics at UIUC</p>
    
    <ul class="sidebar-menu">
      
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/about/">About</a></li>
      
        <li><a href="/contact/">Get in touch</a></li>
      
    </ul>
    <p class="social">
  
  
  
  <a href="https://twitter.com/katester117" data-animate-hover="pulse" class="external twitter">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  <a href="mailto:kalyons3@illinois.edu" data-animate-hover="pulse" class="email">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  
  <a href="http://stackoverflow.com/users/7451811/kate" data-animate-hover="pulse">
    <i class="fa fa-stack-overflow"></i>
  </a>
  
  
  <a href="https://github.com/lyons7" data-animate-hover="pulse">
    <i class="fa fa-github"></i>
  </a>
  
</p>


    <div class="copyright">
      <p class="credit">
        
          &copy;2017 Kate Lyons
        
        | Template by <a href="https://bootstrapious.com/free-templates" class="external">Bootstrapious.com</a>

&amp; ported to Hugo by <a href="https://github.com/kishaningithub">Kishan B</a>

      </p>
    </div>
  </div>
</div>

              
<div class="col-xs-12 col-sm-8 col-md-9 content-column white-background">
  <div class="small-navbar visible-xs">
  <button type="button" data-toggle="offcanvas" class="btn btn-ghost pull-left"> <i class="fa fa-align-left"> </i>Menu</button>
  <h1 class="small-navbar-heading"><a href="/">Kate Lyons</a></h1>
</div>

  <div class="row">
    <div class="col-lg-8">
      <div class="content-column-content">
         <h1>Thesis Time!</h1>
         <div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The following is all of the code used to run analyses used in my dissertation.</p>
<pre class="r"><code>packs = c(&quot;twitteR&quot;,&quot;RCurl&quot;,&quot;RJSONIO&quot;,&quot;stringr&quot;,&quot;ggplot2&quot;,&quot;devtools&quot;,&quot;DataCombine&quot;,&quot;ggmap&quot;,&quot;topicmodels&quot;,&quot;slam&quot;,&quot;Rmpfr&quot;,&quot;tm&quot;,&quot;stringr&quot;,&quot;wordcloud&quot;,&quot;plyr&quot;,&quot;tidytext&quot;,&quot;dplyr&quot;,&quot;tidyr&quot;,&quot;xlsx&quot;,&quot;ggrepel&quot;,&quot;lubridate&quot;,&quot;purrr&quot;,&quot;broom&quot;, &quot;wordcloud&quot;,&quot;emoGG&quot;,&quot;ldatuning&quot;)

lapply(packs, library, character.only=T)</code></pre>
</div>
<div id="getting-the-data" class="section level2">
<h2>Getting the Data</h2>
<p>To collect data, I used the <a href="https://cran.r-project.org/web/packages/twitteR/twitteR.pdf">twitteR package</a>. I’m interested in the Mission District neighborhood in San Francisco, California. I obtain a set of coordinates using Google maps and plug that into the ‘geocode’ parameter and then set a radius of 1 kilometer. I know from experience that I only get around 1,000 - 2,000 posts per time I do this, so I set the number of tweets (n) I would like to get from Twitter at ‘7,000’.</p>
<pre class="r"><code># key = &quot;YOUR KEY HERE&quot;
# secret = &quot;YOUR SECRET HERE&quot;

# tok = &quot;YOUR TOK HERE&quot;
# tok_sec = &quot;YOUR TOK_SEC HERE&quot;

twitter_oauth &lt;- setup_twitter_oauth(key, secret, tok, tok_sec)

# To collect tweets
geo &lt;- searchTwitter(&#39;&#39;,n=7000, geocode=&#39;37.76,-122.42,1km&#39;,
                     retryOnRateLimit=1)</code></pre>
<p>Now I want to identify emojis and separate just those posts that came from Instagram. I then save those to a CSV file and compile it by copy-pasting by hand to get a corpus.</p>
<pre class="r"><code># Now you have a list of tweets. Lists are very difficult to deal with in R, so you convert this into a data frame:
geoDF&lt;-twListToDF(geo)</code></pre>
<p>Chances are there will be emojis in your Twitter data. You can ‘transform’ these emojis into prose using this code as well as a <a href="https://github.com/lyons7/emojidictionary">CSV file</a> I’ve put together of what all of the emojis look like in R. (The idea for this comes from <a href="http://opiateforthemass.es/articles/emoticons-in-R/">Jessica Peterka-Bonetta’s work</a> – she has a list of emojis as well, but it does not include the newest batch of emojis, Unicode Version 9.0, nor the different skin color options for human-based emojis). If you use this emoji list for your own research, please make sure to acknowledge both myself and Jessica.</p>
<p>Load in the CSV file. You want to make sure it is located in the correct working directory so R can find it when you tell it to read it in.</p>
<pre class="r"><code>emoticons &lt;- read.csv(&quot;Decoded Emojis Col Sep.csv&quot;, header = T)</code></pre>
<p>To transform the emojis, you first need to transform the tweet data into ASCII:</p>
<pre class="r"><code>geoDF$text &lt;- iconv(geoDF$text, from = &quot;latin1&quot;, to = &quot;ascii&quot;, 
                    sub = &quot;byte&quot;)</code></pre>
<p>To ‘count’ the emojis you do a find and replace using the <a href="https://github.com/lyons7/emojidictionary">CSV file of ‘Decoded Emojis’</a> as a reference. Here I am using the <a href="http://www.inside-r.org/packages/cran/DataCombine/docs/FindReplace">DataCombine package</a>. What this does is identifies emojis in the tweets and then replaces them with a prose version. I used whatever description pops up when hovering one’s cursor over an emoji on an Apple emoji keyboard. If not completely the same as other platforms, it provides enough information to find the emoji in question if you are not sure which one was used in the post.</p>
<pre class="r"><code>data &lt;- FindReplace(data = geoDF, Var = &quot;text&quot;, 
                      replaceData = emoticons,
                      from = &quot;R_Encoding&quot;, to = &quot;Name&quot;, 
                      exact = FALSE)</code></pre>
<p>Now might be a good time to save this file, perhaps in CSV format with the date of when the data was collected:</p>
<pre class="r"><code>write.csv(data,file=paste(&quot;ALL&quot;,Sys.Date(),&quot;.csv&quot;))</code></pre>
<p>Subset to just those posts that come from Instagram Now you have a data frame which you can manipulate in various ways. For my research, I’m just interested in posts that have occured on Instagram. (Why not just access them via Instagram’s API you ask? Long story short: they are very <em>very</em> conservative about providing access for academic research). I’ve found a work-around which is filtering mined tweets by those that have Instagram as a source:</p>
<pre class="r"><code>data &lt;- data[data$statusSource == &quot;&lt;a href=\&quot;http://instagram.com\&quot; rel=\&quot;nofollow\&quot;&gt;Instagram&lt;/a&gt;&quot;, ]

#Save this file
write.csv(data,file=paste(&quot;INSTA&quot;,Sys.Date(),&quot;.csv&quot;))</code></pre>
<p>Having done this for eight months, we have a nice corpus! Let’s load that in.</p>
</div>
<div id="analyzing-the-data" class="section level2">
<h2>Analyzing the Data</h2>
<div id="preparing-data-for-topic-modeling-and-sentiment-analysis" class="section level4">
<h4>Preparing data for Topic Modeling and Sentiment Analysis</h4>
<p>The data need to be processed a bit more in order to analyze them. Let’s try from the start with <a href="http://tidytextmining.com/">Silge and Robinson</a>.</p>
<pre class="r"><code># Get rid of stuff particular to the data (here encodings of links and such)
# Most of these are characters I don&#39;t have encodings for (other scripts, etc.)

tweets$text = gsub(&quot;Just posted a photo&quot;,&quot;&quot;, tweets$text)
tweets$text = gsub( &quot;&lt;.*?&gt;&quot;, &quot;&quot;, tweets$text)

# Get rid of super frequent spam posters
tweets &lt;- tweets[! tweets$screenName %in% c(&quot;4AMSOUNDS&quot;,&quot;BruciusTattoo&quot;,&quot;LionsHeartSF&quot;,&quot;hermesalchemist&quot;,&quot;Mrsourmash&quot;,&quot;AaronTheEra&quot;,&quot;AmnesiaBar&quot;,&quot;audreymose2&quot;,&quot;audreymosez&quot;,&quot;Bernalcutlery&quot;,&quot;blncdbrkfst&quot;,&quot;BrunosSF&quot;,&quot;chiddythekidd&quot;,&quot;ChurchChills&quot;,&quot;deeXiepoo&quot;,&quot;fabricoutletsf&quot;,&quot;gever&quot;,&quot;miramirasf&quot;,&quot;papalote415&quot;,&quot;HappyHoundsMasg&quot;,&quot;faern_me&quot;),]

# If you want to combine colors, run this at least 3 times over to make sure it &#39;sticks&#39;
# coltweets &lt;- tweets
# coltweets$text &lt;- gsub(&quot; COLONE &quot;, &quot;COLONE&quot;, coltweets$text)
# coltweets$text &lt;- gsub(&quot; COLTWO &quot;, &quot;COLTWO&quot;, coltweets$text)
# coltweets$text &lt;- gsub(&quot; COLTHREE &quot;, &quot;COLTHREE&quot;, coltweets$text)
# coltweets$text &lt;- gsub(&quot; COLFOUR &quot;, &quot;COLFOUR&quot;, coltweets$text)
# coltweets$text &lt;- gsub(&quot; COLFIVE &quot;, &quot;COLFIVE&quot;, coltweets$text)

# Let&#39;s just use this for now. Maybe good to keep these things together
# tweets &lt;- coltweets

# This makes a larger list of stop words combining those from the tm package and tidy text -- even though the tm package stop word list is pretty small anyway, just doing this just in case
data(stop_words)
mystopwords &lt;- c(stopwords(&#39;english&#39;),stop_words$word, stopwords(&#39;spanish&#39;))

# Now for Silge and Robinson&#39;s code. What this is doing is getting rid of 
# URLs, re-tweets (RT) and ampersands. This also gets rid of stop words 
# without having to get rid of hashtags and @ signs by using 
# str_detect and filter! 
reg &lt;- &quot;([^A-Za-z_\\d#@&#39;]|&#39;(?![A-Za-z_\\d#@]))&quot;
tidy_tweets &lt;- tweets %&gt;% 
  filter(!str_detect(text, &quot;^RT&quot;)) %&gt;%
  mutate(text = str_replace_all(text, &quot;https://t.co/[A-Za-z\\d]+|http://[A-Za-z\\d]+|&amp;amp;|&amp;lt;|&amp;gt;|RT|https&quot;, &quot;&quot;)) %&gt;%
  unnest_tokens(word, text, token = &quot;regex&quot;, pattern = reg) %&gt;%
  filter(!word %in% mystopwords,
         str_detect(word, &quot;[a-z]&quot;))</code></pre>
</div>
</div>
<div id="frequency-analysis-and-sentiment-analysis" class="section level2">
<h2>Frequency analysis and Sentiment analysis</h2>
<pre class="r"><code>freq &lt;- tidy_tweets %&gt;% 
  group_by(latitude,longitude) %&gt;% 
  count(word, sort = TRUE) %&gt;% 
  left_join(tidy_tweets %&gt;% 
              group_by(latitude,longitude) %&gt;% 
              summarise(total = n())) %&gt;%
  mutate(freq = n/total)</code></pre>
<p>The n here is the total number of times this term has shown up, and the total is how many terms there are present in a particular coordinate. Now we have a representation of terms, their frequency and their position. Now I might want to plot this somehow… one way would be to try to plot the most frequent terms (n &gt; 50) (Some help on how to do this was taken from <a href="http://blog.revolutionanalytics.com/2016/01/avoid-overlapping-labels-in-ggplot2-charts.html">here</a> and <a href="http://stackoverflow.com/questions/14288001/geom-text-not-working-when-ggmap-and-geom-point-used">here</a>)</p>
<pre class="r"><code>freq2 &lt;- subset(freq, n &gt; 50) 

map &lt;- get_map(location = &#39;Valencia St. and 20th, San Francisco,
               California&#39;, zoom = 15)

freq2$longitude&lt;-as.numeric(freq2$longitude)
freq2$latitude&lt;-as.numeric(freq2$latitude)

mapPoints &lt;- ggmap(map) + geom_jitter(alpha = 0.1, size = 2.5, width = 0.25, height = 0.25) +
  geom_label_repel(data = freq2, aes(x = longitude, y = latitude, label = word),size = 3) </code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Let’s zoom into that main central area to see what’s going on!</p>
<pre class="r"><code>map2 &lt;- get_map(location = &#39;Valencia St. and 19th, San Francisco,
               California&#39;, zoom = 16)
mapPoints2 &lt;- ggmap(map2) + geom_jitter(alpha = 0.1, size = 2.5, width = 0.25, height = 0.25) +
  geom_label_repel(data = freq2, aes(x = longitude, y = latitude, label = word),size = 3) </code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>What about 24th?</p>
<pre class="r"><code># Have to go a bit bigger to get more terms
freq3 &lt;- subset(freq, n &gt; 15) 

map3 &lt;- get_map(location = &#39;Folsom St. and 24th, San Francisco,
               California&#39;, zoom = 16)
mapPoints3 &lt;- ggmap(map3) + geom_jitter(alpha = 0.1, size = 2.5, width = 0.25, height = 0.25) +
  geom_label_repel(data = freq3, aes(x = longitude, y = latitude, label = word),size = 3) </code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="sentiment-analysis" class="section level2">
<h2>Sentiment analysis</h2>
<pre class="r"><code># We can also look at counts of negative and positive words
bingsenti &lt;- sentiments %&gt;%
  filter(lexicon ==&quot;bing&quot;)

bing_word_counts &lt;- tidy_tweets %&gt;%
  inner_join(bingsenti) %&gt;%
  count(word, sentiment, sort = TRUE) %&gt;%
  ungroup()
# If you wanted to look at these
# bing_word_counts</code></pre>
<pre class="r"><code># Now we can graph these
bing_word_counts %&gt;%
  filter(n &gt; 25) %&gt;%
  mutate(n = ifelse(sentiment == &quot;negative&quot;, -n, n)) %&gt;%
  mutate(word = reorder(word, n)) %&gt;%
  ggplot(aes(word, n, fill = sentiment)) +
  geom_bar(alpha = 0.8, stat = &quot;identity&quot;) +
  labs(y = &quot;Contribution to sentiment&quot;,
       x = NULL) +
  coord_flip()</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="word-cloud" class="section level2">
<h2>Word Cloud</h2>
<p>In order to do a word cloud we need a document term matrix. This will also be used for topic modeling later.</p>
<pre class="r"><code># First have to make a document term matrix, which involves a few steps
tidy_tweets %&gt;%
  count(document, word, sort=TRUE)

tweet_words &lt;- tidy_tweets %&gt;%  
  count(document, word) %&gt;%
  ungroup()

total_words &lt;- tweet_words %&gt;% 
  group_by(document) %&gt;% 
  summarize(total = sum(n))

post_words &lt;- left_join(tweet_words, total_words)

dtm &lt;- post_words %&gt;% 
  cast_dtm(document, word, n)</code></pre>
<pre class="r"><code>freqw = data.frame(sort(colSums(as.matrix(dtm)), decreasing=TRUE))
wordcloud(rownames(freqw), freqw[,1], max.words=100, 
          colors=brewer.pal(1, &quot;Dark2&quot;))</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="emojis" class="section level2">
<h2>Emojis</h2>
<p>What if I want to look at just those posts that have emojis in them? Or specific emojis in general?</p>
<pre class="r"><code># Identify emojis
emoticons &lt;- read.csv(&quot;Decoded Emojis Col Sep.csv&quot;, header = T)
# This also takes time so I will not run it, but this is how you go through and identify emojis in your corpus and &#39;tag&#39; whether or not they are there!
# emogrepl &lt;- grepl(paste(emoticons$Name, collapse = &quot;|&quot;), tweets$text)
# save(emogrepl,file=paste(&quot;emo.Rda&quot;))
# Emo here: https://www.dropbox.com/s/fqlvqfnx0n8npf2/emo.Rda?dl=0
load(&quot;emo.Rda&quot;)
emogreplDF&lt;-as.data.frame(emogrepl)
tweets$id &lt;- 1:nrow(tweets)
emogreplDF$id &lt;- 1:nrow(emogreplDF)
tweets &lt;- merge(tweets,emogreplDF,by=&quot;id&quot;)
emosub &lt;- tweets[tweets$emogrepl == &quot;TRUE&quot;, ]

# to get JUST emojis, no text

tidy_emos &lt;- emosub %&gt;% 
  mutate(text = str_replace_all(text, &quot;https://t.co/[A-Za-z\\d]+|http://[A-Za-z\\d]+|&amp;amp;|&amp;lt;|&amp;gt;|RT|https&quot;, &quot;&quot;)) %&gt;%
  unnest_tokens(word, text, token = &quot;regex&quot;, pattern = reg) %&gt;%
  filter(!word %in% mystopwords,
         str_detect(word, &quot;[a-z]&quot;))

# Have to do this so they will recognize each other
tidy_emoticons &lt;- emoticons %&gt;% 
  mutate(Name = str_replace_all(Name, &quot;https://t.co/[A-Za-z\\d]+|http://[A-Za-z\\d]+|&amp;amp;|&amp;lt;|&amp;gt;|RT|https&quot;, &quot;&quot;)) %&gt;%
  unnest_tokens(word, Name, token = &quot;regex&quot;, pattern = reg) %&gt;%
  filter(!word %in% mystopwords,
         str_detect(word, &quot;[a-z]&quot;))

# I think a semi_join will work: &quot;Return all rows from X where there are matching rows in Y, just keeping columns from X&quot; (http://stat545.com/bit001_dplyr-cheatsheet.html)

emoonly &lt;- semi_join(tidy_emos, tidy_emoticons, by=&quot;word&quot;)

freqe &lt;- emoonly %&gt;% 
  group_by(latitude,longitude) %&gt;% 
  count(word, sort = TRUE) %&gt;% 
  left_join(emoonly %&gt;% 
              group_by(latitude,longitude) %&gt;% 
              summarise(total = n())) %&gt;%
  mutate(freq = n/total)

# freqe

# Map it
freqe2 &lt;- subset(freqe, n &gt; 20) 

map &lt;- get_map(location = &#39;Valencia St. and 20th, San Francisco,
               California&#39;, zoom = 15)

freqe2$longitude&lt;-as.numeric(freqe2$longitude)
freqe2$latitude&lt;-as.numeric(freqe2$latitude)

mapPointse &lt;- ggmap(map) + geom_jitter(alpha = 0.1, size = 2.5, width = 0.25, height = 0.25) +
  geom_label_repel(data = freqe2, aes(x = longitude, y = latitude, label = word),size = 3) </code></pre>
<pre class="r"><code>mapPointse</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="mapping-emojis" class="section level2">
<h2>Mapping Emojis</h2>
<p>To visualize emojis in our corpus, we use the <a href="https://github.com/dill/emoGG">emoGG package</a>. (See also <a href="https://lyons7.github.io/portfolio/2017-03-10-emoji-maps/">here</a>!) I will do a map of the most common emoji (SPARKLES) and ones related to food. This might be better on a subset so we can try that too…</p>
<pre class="r"><code># Let&#39;s do coffee, the egg pan thing, face savouring delicious food + ice cream?
# ice cream 1f368
# To find the codes for each emoji:
# emoji_search(&quot;ice_cream&quot;)
# First create a subset of just those that have ICE CREAM emoji present
icecreamg &lt;- grepl(paste(&quot; ICECREAM &quot;), emosub$text)
icecreamgD&lt;-as.data.frame(icecreamg)
emosub$ID7 &lt;- 1:nrow(emosub)
icecreamgD$ID7 &lt;- 1:nrow(icecreamgD)
emosub &lt;- merge(emosub,icecreamgD,by=&quot;ID7&quot;)
icecream &lt;- emosub[emosub$icecreamg == &quot;TRUE&quot;, ]

# Same for &#39;Face Savouring Delicious Food&#39;
# savourfood: 1f60b
savourfoodgrepl &lt;- grepl(paste(&quot; FACESAVOURINGDELICIOUSFOOD &quot;), emosub$text)
savourfoodgreplDF&lt;-as.data.frame(savourfoodgrepl)
emosub$ID7 &lt;- 1:nrow(emosub)
savourfoodgreplDF$ID7 &lt;- 1:nrow(savourfoodgreplDF)
emosub &lt;- merge(emosub,savourfoodgreplDF,by=&quot;ID7&quot;)
savourfood &lt;- emosub[emosub$savourfoodgrepl == &quot;TRUE&quot;, ]

#coffee: 2615
hotbevg &lt;- grepl(paste(&quot; HOTBEVERAGE &quot;), emosub$text)
hotbevgD&lt;-as.data.frame(hotbevg)
emosub$id &lt;- 1:nrow(emosub)
hotbevgD$id &lt;- 1:nrow(hotbevgD)
emosub &lt;- merge(emosub,hotbevgD,by=&quot;id&quot;)
coffee &lt;- emosub[emosub$hotbevg == &quot;TRUE&quot;, ] 

#knifeandfork: 1f374
mackg &lt;- grepl(paste(&quot; FORKANDKNIFE &quot;), emosub$text)
mackgD&lt;-as.data.frame(mackg)
emosub$id &lt;- 1:nrow(emosub)
mackgD$id &lt;- 1:nrow(mackgD)
emosub &lt;- merge(emosub,mackgD,by=&quot;id&quot;)
mack &lt;- emosub[emosub$mackg == &quot;TRUE&quot;, ]

#cooking: # Frying pan egg - Food
# 1f373
cookg &lt;- grepl(paste(&quot; COOKING &quot;), emosub$text)
cookgD&lt;-as.data.frame(cookg)
emosub$id &lt;- 1:nrow(emosub)
cookgD$id &lt;- 1:nrow(cookgD)
emosub &lt;- merge(emosub,cookgD,by=&quot;id&quot;)
cook &lt;- emosub[emosub$cookg == &quot;TRUE&quot;, ]


# Map this
foodmap &lt;- ggmap(map) + geom_emoji(aes(x = longitude, y = latitude), 
                                     data=savourfood, emoji=&quot;1f60b&quot;) +
                              geom_emoji(aes(x=longitude, y=latitude),
                                     data=cook, emoji=&quot;1f373&quot;) +
                              geom_emoji(aes(x=longitude, y=latitude),
                                     data=coffee, emoji=&quot;2615&quot;) +
                              geom_emoji(aes(x=longitude, y=latitude),
                                     data=mack, emoji=&quot;1f374&quot;) +
                              geom_emoji(aes(x=longitude, y=latitude),
                                     data=icecream, emoji=&quot;1f368&quot;)</code></pre>
<pre class="r"><code>foodmap</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code># Artist palette
#1f3a8
arg &lt;- grepl(paste(&quot; ARTISTPALETTE &quot;), emosub$text)
argD&lt;-as.data.frame(arg)
emosub$id &lt;- 1:nrow(emosub)
argD$id &lt;- 1:nrow(argD)
emosub &lt;- merge(emosub,argD,by=&quot;id&quot;)
art &lt;- emosub[emosub$arg == &quot;TRUE&quot;, ]

artmap &lt;- ggmap(map) + geom_emoji(aes(x = longitude, y = latitude), 
                                     data=art, emoji=&quot;1f3a8&quot;)</code></pre>
<pre class="r"><code>artmap</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre class="r"><code>sparklesgrepl &lt;- grepl(paste(&quot; SPARKLES &quot;), emosub$text)
sparklesgreplDF&lt;-as.data.frame(sparklesgrepl)
emosub$ID7 &lt;- 1:nrow(emosub)
sparklesgreplDF$ID7 &lt;- 1:nrow(sparklesgreplDF)
emosub &lt;- merge(emosub,sparklesgreplDF,by=&quot;ID7&quot;)
sparkles &lt;- emosub[emosub$sparklesgrepl == &quot;TRUE&quot;, ]

sparkplug &lt;- ggmap(map) + geom_emoji(aes(x = longitude, y = latitude), 
                                     data=sparkles, emoji=&quot;2728&quot;)</code></pre>
<pre class="r"><code>sparkplug</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="topic-modeling" class="section level2">
<h2>Topic Modeling</h2>
<div id="lda-tuning" class="section level4">
<h4>LDA Tuning</h4>
<p>Before running a topic model, I am going to try the <a href="http://rpubs.comci/siri/ldatuning">LDA tuning package</a> to assess what might be a good number of topics.</p>
<pre class="r"><code># devtools::install_github(&quot;nikita-moor/ldatuning&quot;)
# install.packages(&quot;ldatuning&quot;)
library(&quot;ldatuning&quot;)
library(&quot;topicmodels&quot;)
# I will not run this at the moment because it takes forever!
# result &lt;- FindTopicsNumber(
#   dtm,
#   topics = seq(from = 2, to = 15, by = 1),
#   metrics = c(&quot;Griffiths2004&quot;, &quot;CaoJuan2009&quot;, &quot;Arun2010&quot;, &quot;Deveaud2014&quot;),
#   method = &quot;Gibbs&quot;,
#   control = list(seed = 77),
#   mc.cores = 2L,
#   verbose = TRUE
# )</code></pre>
<p>When this finally finishes running, we will do the following to look at graphs of results to see ‘best’ topic number. I guess you want that range which is minimize at its lowest and maximize at its highest. So match those up.</p>
<pre class="r"><code># From here: https://www.dropbox.com/s/qplfwb0pazmk7c1/ldatuning.RData?dl=0
load(&quot;ldatuning.RData&quot;)

FindTopicsNumber_plot(result)</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>From this, it appears that the maximum and minimum peak points are about 22. I’ll use that as my number of topics.</p>
<pre class="r"><code># load(&quot;dtm.Rda&quot;)
# Set parameters for Gibbs sampling (parameters those used in
# Grun and Hornik 2011)
# burnin &lt;- 4000
# iter &lt;- 2000
# thin &lt;- 500
# seed &lt;-list(2003,5,63,100001,765)
# nstart &lt;- 5
# best &lt;- TRUE
# k &lt;- 22
# This also takes a while to run, so will just load in results
# lda &lt;-LDA(dtm,k, method=&quot;Gibbs&quot;, 
#              control=list(nstart=nstart, seed = seed, best=best, 
#                           burnin = burnin, iter = iter, thin=thin))
# 
# # Save this (so you don&#39;t have to keep running it all the time)
# save(lda,file=paste(&quot;LDA&quot;,k,&quot;.Rda&quot;))

# Let&#39;s check out the results

# test_lda_td &lt;- tidy(test_lda)
# From here: https://www.dropbox.com/s/4fp81smd3dbrpd6/LDA%2022%20.Rda?dl=0
load(&quot;LDA 22 .Rda&quot;)
# Make it tidy to visualize it, etc.
lda_td &lt;- tidy(lda)

# To graph these results (too many for now, looks messy)
# lda_top_terms &lt;- lda_td %&gt;%
#   group_by(topic) %&gt;%
#   top_n(10, beta) %&gt;%
#   ungroup() %&gt;%
#   arrange(topic, -beta)
# 
# top_terms &lt;- lda_top_terms %&gt;%
#   mutate(term = reorder(term, beta)) %&gt;%
#   ggplot(aes(term, beta, fill = factor(topic))) +
#   geom_bar(stat = &quot;identity&quot;, show.legend = FALSE) +
#   facet_wrap(~ topic, scales = &quot;free&quot;) +
#   coord_flip()
# 
# top_terms</code></pre>
</div>
</div>
<div id="pairing-this-back-with-original-tweets" class="section level2">
<h2>Pairing this back with original tweets</h2>
<p>Pair back this information with the original tweets to see how topics are distribtued, learn more about what each topic entails, etc.</p>
<pre class="r"><code># Also to link things back
# Look at results
# Maybe a little easier to see than tidy graph
lda.topics &lt;- as.matrix(topics(lda))
terms(lda,10)</code></pre>
<pre><code>##       Topic 1       Topic 2 Topic 3     Topic 4        Topic 5   
##  [1,] &quot;happy&quot;       &quot;home&quot;  &quot;day&quot;       &quot;amazing&quot;      &quot;bar&quot;     
##  [2,] &quot;birthday&quot;    &quot;live&quot;  &quot;beautiful&quot; &quot;chapel&quot;       &quot;time&quot;    
##  [3,] &quot;party&quot;       &quot;black&quot; &quot;favorite&quot;  &quot;ready&quot;        &quot;taqueria&quot;
##  [4,] &quot;fire&quot;        &quot;rose&quot;  &quot;check&quot;     &quot;friend&quot;       &quot;friday&quot;  
##  [5,] &quot;friends&quot;     &quot;music&quot; &quot;days&quot;      &quot;special&quot;      &quot;taco&quot;    
##  [6,] &quot;weekend&quot;     &quot;sweet&quot; &quot;putt&quot;      &quot;water&quot;        &quot;sushi&quot;   
##  [7,] &quot;holiday&quot;     &quot;real&quot;  &quot;urban&quot;     &quot;awesome&quot;      &quot;baby&quot;    
##  [8,] &quot;family&quot;      &quot;days&quot;  &quot;heath&quot;     &quot;flour&quot;        &quot;theater&quot; 
##  [9,] &quot;paypopper&quot;   &quot;sf&quot;    &quot;lovely&quot;    &quot;@thechapelsf&quot; &quot;lunch&quot;   
## [10,] &quot;celebrating&quot; &quot;basil&quot; &quot;ceramics&quot;  &quot;shot&quot;         &quot;ramen&quot;   
##       Topic 6              Topic 7         Topic 8    Topic 9    
##  [1,] &quot;facewithtearsofjoy&quot; &quot;love&quot;          &quot;night&quot;    &quot;francisco&quot;
##  [2,] &quot;armory&quot;             &quot;heavyblackhea&quot; &quot;tonight&quot;  &quot;san&quot;      
##  [3,] &quot;alamo&quot;              &quot;city&quot;          &quot;saturday&quot; &quot;mission&quot;  
##  [4,] &quot;drafthouse&quot;         &quot;building&quot;      &quot;tomorrow&quot; &quot;district&quot; 
##  [5,] &quot;club&quot;               &quot;guys&quot;          &quot;bay&quot;      &quot;#igerssf&quot; 
##  [6,] &quot;life&quot;               &quot;people&quot;        &quot;monday&quot;   &quot;yeah&quot;     
##  [7,] &quot;video&quot;              &quot;time&quot;          &quot;playing&quot;  &quot;cookie&quot;   
##  [8,] &quot;fun&quot;                &quot;techo&quot;         &quot;books&quot;    &quot;streets&quot;  
##  [9,] &quot;kink&quot;               &quot;trip&quot;          &quot;free&quot;     &quot;dr&quot;       
## [10,] &quot;posted&quot;             &quot;hard&quot;          &quot;amnesia&quot;  &quot;beer&quot;     
##       Topic 10                     Topic 11       Topic 12 
##  [1,] &quot;tartine&quot;                    &quot;food&quot;         &quot;dinner&quot; 
##  [2,] &quot;manufactory&quot;                &quot;week&quot;         &quot;photo&quot;  
##  [3,] &quot;bakery&quot;                     &quot;dog&quot;          &quot;bear&quot;   
##  [4,] &quot;stop&quot;                       &quot;cheese&quot;       &quot;lazy&quot;   
##  [5,] &quot;@sfmanufactory&quot;             &quot;school&quot;       &quot;foreign&quot;
##  [6,] &quot;cream&quot;                      &quot;wineglass&quot;    &quot;cinema&quot; 
##  [7,] &quot;bread&quot;                      &quot;trick&quot;        &quot;ladies&quot; 
##  [8,] &quot;ice&quot;                        &quot;perfect&quot;      &quot;#repost&quot;
##  [9,] &quot;facesavouringdeliciousfood&quot; &quot;tour&quot;         &quot;miss&quot;   
## [10,] &quot;pizza&quot;                      &quot;forkandknife&quot; &quot;painted&quot;
##       Topic 13                          Topic 14    Topic 15          
##  [1,] &quot;colone&quot;                          &quot;san&quot;       &quot;#sanfrancisco&quot;   
##  [2,] &quot;sparkles&quot;                        &quot;mission&quot;   &quot;#sf&quot;             
##  [3,] &quot;coltwo&quot;                          &quot;francisco&quot; &quot;#mission&quot;        
##  [4,] &quot;colthree&quot;                        &quot;district&quot;  &quot;#missiondistrict&quot;
##  [5,] &quot;twoheas&quot;                         &quot;#igerssf&quot;  &quot;#california&quot;     
##  [6,] &quot;okhandsign&quot;                      &quot;fran&quot;      &quot;#dolorespark&quot;    
##  [7,] &quot;personraisinghandsincelebration&quot; &quot;reading&quot;   &quot;#bayarea&quot;        
##  [8,] &quot;personwithfoldedhands&quot;           &quot;#sfo&quot;      &quot;#themission&quot;     
##  [9,] &quot;colfour&quot;                         &quot;break&quot;     &quot;#usa&quot;            
## [10,] &quot;signofthehorns&quot;                  &quot;bright&quot;    &quot;#sanfran&quot;        
##       Topic 16                       Topic 17           Topic 18  
##  [1,] &quot;smilingfacewithheashapedeyes&quot; &quot;park&quot;             &quot;mission&quot; 
##  [2,] &quot;studios&quot;                      &quot;dolores&quot;          &quot;street&quot;  
##  [3,] &quot;finally&quot;                      &quot;sf&quot;               &quot;art&quot;     
##  [4,] &quot;sunday&quot;                       &quot;blacksunwithrays&quot; &quot;valencia&quot;
##  [5,] &quot;yesterday&quot;                    &quot;#dolorespark&quot;     &quot;24th&quot;    
##  [6,] &quot;pacific&quot;                      &quot;palmtree&quot;         &quot;station&quot; 
##  [7,] &quot;studio&quot;                       &quot;afternoon&quot;        &quot;st&quot;      
##  [8,] &quot;southern&quot;                     &quot;bridgeatnight&quot;    &quot;16th&quot;    
##  [9,] &quot;pretty&quot;                       &quot;sunny&quot;            &quot;cha&quot;     
## [10,] &quot;fur&quot;                          &quot;summer&quot;           &quot;gray&quot;    
##       Topic 19        Topic 20     Topic 21    Topic 22     
##  [1,] &quot;alley&quot;         &quot;kitchen&quot;    &quot;time&quot;      &quot;coffee&quot;     
##  [2,] &quot;clarion&quot;       &quot;#foodporn&quot;  &quot;elbo&quot;      &quot;morning&quot;    
##  [3,] &quot;#sf&quot;           &quot;restaurant&quot; &quot;chocolate&quot; &quot;cafe&quot;       
##  [4,] &quot;#streetart&quot;    &quot;super&quot;      &quot;fun&quot;       &quot;hotbeverage&quot;
##  [5,] &quot;#art&quot;          &quot;story&quot;      &quot;mission&quot;   &quot;barrel&quot;     
##  [6,] &quot;#graffiti&quot;     &quot;brunch&quot;     &quot;christmas&quot; &quot;#coffee&quot;    
##  [7,] &quot;#clarionalley&quot; &quot;chicken&quot;    &quot;theatre&quot;   &quot;tea&quot;        
##  [8,] &quot;#mural&quot;        &quot;#food&quot;      &quot;house&quot;     &quot;shop&quot;       
##  [9,] &quot;mural&quot;         &quot;thai&quot;       &quot;hot&quot;       &quot;ritual&quot;     
## [10,] &quot;link&quot;          &quot;craftsman&quot;  &quot;church&quot;    &quot;acrylic&quot;</code></pre>
<pre class="r"><code># Check at top 50 terms in each topic
# lda.terms &lt;- as.matrix(terms(lda,15))
# Save as CSV file to look at a bit closer
# write.csv(lda.terms,file=paste(&quot;TIDY_LDA&quot;,k,&quot;TopicstoTerms.csv&quot;))

# Actual probabilities
topicProbabilities &lt;- as.data.frame(lda@gamma)
# write.csv(topicProbabilities,
#          file=paste(&quot;TIDYLDA&quot;,k,&quot;TopicProbabilities.csv&quot;))

#Write out the topics to a data frame so you can work with them
test &lt;- as.data.frame(lda.topics)
# We won&#39;t label these topics bc too many, difficult to label. If you wanted to label, however, this is how you would do it. 
# a&lt;-c(&#39;Evaluation&#39;, &#39;Food&#39;,&#39;Performance Promos&#39;, &#39;Leisure&#39;, &#39;Places&#39;,
# &#39;Nightlife&#39;, &#39;Activism/Campaigns&#39;,&#39;Art&#39;,&#39;Outdoors&#39;,&#39;Service/Product Promos&#39;)
# b&lt;-c(1,2,3,4,5,6,7,8,9,10)
# namesdf&lt;-data.frame(&quot;Name&quot;=a,&quot;Number&quot;=b)
# test$V1&lt;-as.factor(test$V1)
# newtopics &lt;- FindReplace(data = test, Var = &quot;V1&quot;, replaceData = namesdf,
#                        from = &quot;Number&quot;, to = &quot;Name&quot;, exact = TRUE)

#Merge topics with tweet corpus
tweets$id &lt;- 1:nrow(tweets)
test$id &lt;- 1:nrow(test)
tweets &lt;- merge(tweets,test,by=&quot;id&quot;)
# Save this
# save(tweets,file=paste(&quot;tweets&quot;,Sys.Date(),&quot;.Rda&quot;))
# load(&quot;tweets 2017-03-22 .Rda&quot;)

#Merge topic probabilities with tweet corpus
topicProbabilities$id &lt;- 1:nrow(topicProbabilities)
tweets &lt;- merge(tweets, topicProbabilities,by=&quot;id&quot;)</code></pre>
</div>
<div id="visualizing-topic-model-results" class="section level2">
<h2>Visualizing Topic Model Results</h2>
<p>You can now map your posts and see where assigned topics are happening!</p>
<pre class="r"><code>tweets$longitude&lt;-as.numeric(tweets$longitude)
tweets$latitude &lt;- as.numeric(tweets$latitude)
tweets$V1.x &lt;- factor(tweets$V1.x)
Topics&lt;-tweets$V1.x
mapPointstopics &lt;- ggmap(map) + geom_point(aes(x = longitude, y = latitude, 
                                         color=Topics), 
                                     data=tweets, alpha=0.5, size = 3)</code></pre>
<pre class="r"><code>mapPointstopics</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>What a mess!</p>
<p>How about over time?</p>
</div>
<div id="visualizing-the-data" class="section level2">
<h2>Visualizing the data</h2>
<p>We can also look at WHEN the posts were generated. We can make a graph of post frequency over time.Graphs constructed with help from <a href="http://www.cyclismo.org/tutorial/R/time.html">here</a>, <a href="https://gist.github.com/stephenturner/3132596">here</a>, <a href="http://stackoverflow.com/questions/27626915/r-graph-frequency-of-observations-over-time-with-small-value-range">here</a>, <a href="http://michaelbommarito.com/2011/03/12/a-quick-look-at-march11-saudi-tweets/">here</a>, <a href="http://stackoverflow.com/questions/31796744/plot-count-frequency-of-tweets-for-word-by-month">here</a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/as.POSIXlt.html">here</a>, <a href="http://sape.inf.usi.ch/quick-reference/ggplot2/geom">here</a> and <a href="http://stackoverflow.com/questions/3541713/how-to-plot-two-histograms-together-in-r">here</a>.</p>
<pre class="r"><code>tweets$created2 &lt;- as.POSIXct(tweets$created, format=&quot;%m/%d/%Y %H:%M&quot;)
tweets$created3&lt;-format(tweets$created2,&#39;%H:%M:%S&#39;)
d3 &lt;- as.data.frame(table(tweets$created3))
d3 &lt;- d3[order(d3$Freq, decreasing=T), ]
names(d3) &lt;- c(&quot;created3&quot;,&quot;freq3&quot;)
tweets &lt;- merge(tweets,d3,by=&quot;created3&quot;)
tweets$created3 &lt;- as.POSIXct(tweets$created3, format=&quot;%H:%M:%S&quot;)
minutes &lt;- 60

Topics&lt;-tweets$V1.x
Time &lt;- tweets$created3</code></pre>
<pre class="r"><code>ggplot(tweets, aes(Time, color = Topics)) + 
  geom_freqpoly(binwidth=60*minutes)</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<pre class="r"><code># For a more general trend
ggplot(tweets, aes(Time)) + 
  geom_freqpoly(binwidth=60*minutes)</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
</div>
<div id="matching-tweets-with-ll-data" class="section level2">
<h2>Matching tweets with LL data</h2>
<p>What we are trying to do is to match up locations in the physical LL with the digital LL and then find the most common topic associated with a physical location. Because we do not have <em>exact</em> matches, we will try the <a href="https://cran.r-project.org/web/packages/fuzzyjoin/fuzzyjoin.pdf">fuzzyjoin package</a>.</p>
<pre class="r"><code>library(fuzzyjoin)
library(dplyr)
pairsdf &lt;- ll %&gt;%
  geo_inner_join(tweets, unit=&#39;km&#39;,distance_col=&quot;distance&quot;) %&gt;%
  filter(distance &lt;= 0.018288)

# What does this look like on a map?

# mapPointsall &lt;- ggmap(map) + geom_point(aes(x = longitude.x, y = latitude.x), 
#                                     data=pairsdf, alpha=0.5)
# mapPointsall</code></pre>
<p>Now I have a data frame with a row of each time a post has occurred in a 30 foot vicinity of an LL object. What I would like to do is figure out the most common topic that is associated with a particular sign. We’ll use the idea of ‘mode’ here with our topics and the <em>group_by()</em> function from dplyr as suggested <a href="http://stackoverflow.com/questions/25198442/how-to-calculate-mean-median-per-group-in-a-dataframe-in-r">here</a>.</p>
<p>As R does not have a built in function for mode, we build one. Code for this available <a href="https://www.tutorialspoint.com/r/r_mean_median_mode.htm">here</a>.</p>
<pre class="r"><code># To get the mode
getmode &lt;- function(v) {
   uniqv &lt;- unique(v)
   uniqv[which.max(tabulate(match(v, uniqv)))]
}

# Tell R your topic categories are a number so it can deal with them
pairsdf$V1.x&lt;- as.numeric(pairsdf$V1.x)

# Now calculate things about the topics per sign
topicmode &lt;- pairsdf%&gt;%
group_by(SIGN_ID)%&gt;% 
summarise(Mode = getmode(V1.x))</code></pre>
<p>Let’s now combine this with our other data, but just include those instances that have a topic assigned (not all signs got a corresponding tweet)</p>
<pre class="r"><code>topicsigns &lt;- inner_join(ll, topicmode, by = &quot;SIGN_ID&quot;)</code></pre>
<p>This is kind of messy, so let’s subset the data frame to just have the things we are interested in. Help from <a href="https://www.r-bloggers.com/taking-a-subset-of-a-data-frame-in-r/">here</a>.</p>
<pre class="r"><code>topicsigns &lt;- topicsigns[,c(&quot;SIGN_ID&quot;,&quot;latitude&quot;,&quot;longitude&quot;,&quot;LOCATION&quot;,&quot;LANGUAGE&quot;,&quot;COMMUNICATIVE_ROLE&quot;,&quot;MATERIALITY&quot;,&quot;CONTEXT_FRAME&quot;,&quot;YELP&quot;,&quot;CLOSED&quot;,&quot;Mode&quot;)]    # get all rows, only relevant columns

# Rename columns so they make more sense (help from here: http://stackoverflow.com/questions/21502465/replacement-for-rename-in-dplyr/26146202#26146202)
topicsigns &lt;- rename(topicsigns, Topic = Mode)</code></pre>
</div>
<div id="gams" class="section level2">
<h2>GAMs!</h2>
<p>Now onto statistics. We want to see what has the most influence on language displayed in a sign. Let’s use a generalized additive model.</p>
<pre class="r"><code>library(mgcv)
# Let&#39;s visualize our LL data
# We want to change the order on the plot so it&#39;s easier to look at (help from http://stackoverflow.com/questions/12774210/how-do-you-specifically-order-ggplot2-x-axis-instead-of-alphabetical-order)
ll$LANGUAGE &lt;- as.character(ll$LANGUAGE)
Language &lt;- factor(ll$LANGUAGE, levels=c(&quot;English&quot;, &quot;Eng_Span&quot;,&#39;Equal&#39;,&#39;Spanish&#39;, &#39;Span_Eng&#39;,&quot;Other (Chinese)&quot;,&quot;Other (Thai)&quot;,&quot;Other (Tagalog)&quot;))

# Different colors help from http://stackoverflow.com/questions/19778612/change-color-for-two-geom-point-in-ggplot2

# Colorblind palette (help from http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/#a-colorblind-friendly-palette)
# cbPalette &lt;- c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;, &quot;#0072B2&quot;, &quot;#D55E00&quot;, &quot;#CC79A7&quot;)
# mapPoints &lt;- ggmap(map) + geom_point(aes(x = lon, y = lat,color=Language),data=newdata, alpha = 0.7, size=2) + scale_colour_manual(values=cbPalette)

mapll &lt;- get_map(location = &#39;Van Ness and 22nd, San Francisco,
               California&#39;, zoom = 15)


ll$longitude &lt;- as.numeric(ll$longitude)
ll$latitude &lt;- as.numeric(ll$latitude)

Longitude &lt;- ll$longitude
Latitude &lt;- ll$latitude

mapPointsll &lt;- ggmap(mapll) + geom_point(aes(x = Longitude, y = Latitude,color=Language),data=ll, size=1.5) + scale_colour_manual(values = c(&quot;Spanish&quot; = &quot;blue&quot;, &quot;English&quot; = &quot;magenta&quot;, &quot;Eng_Span&quot; = &quot;red&quot;, &quot;Span_Eng&quot; = &quot;#339900&quot;, &quot;Equal&quot; = &quot;orange&quot;, &quot;Other (Chinese)&quot;=&quot;purple&quot;,&quot;Other (Thai)&quot; =&quot;#FFCC00&quot;,&quot;Other (Tagalog)&quot; = &quot;grey&quot; ))</code></pre>
<pre class="r"><code>mapPointsll</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<div id="model-selection" class="section level3">
<h3>Model Selection</h3>
<ul>
<li>Generalized Linear Models (Logistic Regression, Multinomial Logistic Regression)</li>
<li>Pros: Enable a categorical output</li>
<li>Cons: Difficult to capture nonlinear patterns, involves transformation (logit)</li>
<li>Cons: Difficult to include coordinates</li>
<li>Generalized Additive Model</li>
<li>Pros: Relationship between IV and DV not assumed to be linear</li>
<li>Pros: Can deal with coordinates with a smooth! Allows the trend of DV to be summarized as a function of more than one IV (latitude and longitude)</li>
<li>Pros: Can deal with my weird time distribution with a smooth as well!</li>
</ul>
<div id="results" class="section level4">
<h4>Results</h4>
<p>Let’s explore the multinom and see what it can tell us about all of these things</p>
<pre class="r"><code># Plotting the data (help on how to manipulate this graph from here: http://r.789695.n4.nabble.com/Ordering-of-stack-in-ggplot-package-ggplot2-td3917159.html)

# Overall counts

dat &lt;- data.frame(table(ll$LOCATION,ll$LANGUAGE))
dat$Var1 &lt;- factor(dat$Var1, levels = c(&quot;Mission&quot;, &quot;24th&quot;, &quot;Valencia&quot;,&quot;18th&quot;))

dat$Var2 &lt;- factor(dat$Var2, levels = c(&quot;English&quot;, &quot;Eng_Span&quot;, &quot;Equal&quot;,&quot;Span_Eng&quot;,&quot;Spanish&quot;,&quot;Other (Chinese)&quot;,&quot;Other (Thai)&quot;,&quot;Other (Tagalog)&quot;))

names(dat) &lt;- c(&quot;Location&quot;,&quot;Language&quot;,&quot;Count&quot;)
# levels(dat$Language)
ggplot(data=dat, aes(x=Location, y=Count, fill=Language)) + geom_bar(stat=&quot;identity&quot;)</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<pre class="r"><code># Now percentages
please=prop.table(table(ll$LOCATION, ll$LANGUAGE))
please2 &lt;- data.frame(please)
please2$Var1 &lt;- factor(please2$Var1, levels = c(&quot;Mission&quot;, &quot;24th&quot;, &quot;Valencia&quot;,&quot;18th&quot;))

please2$Var2 &lt;- factor(please2$Var2, levels = c(&quot;English&quot;, &quot;Eng_Span&quot;, &quot;Equal&quot;,&quot;Span_Eng&quot;,&quot;Spanish&quot;,&quot;Other (Chinese)&quot;,&quot;Other (Thai)&quot;,&quot;Other (Tagalog)&quot;))

names(please2) &lt;- c(&quot;Location&quot;,&quot;Language&quot;, &quot;Frequency&quot;)
# Help from http://stackoverflow.com/questions/9563368/create-stacked-percent-barplot-in-r
library(scales)
ggplot(please2,aes(x = Location, y = Frequency,fill = Language)) + 
    geom_bar(position = &quot;fill&quot;,stat = &quot;identity&quot;) + 
    scale_y_continuous(labels = percent_format())</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-45-2.png" width="672" /></p>
<div id="multinomial-logistic-regression" class="section level5">
<h5>Multinomial Logistic Regression</h5>
<p>The results of this are so ugly – the p value also has to computed separately. But here is how it is done.</p>
<pre class="r"><code>library(nnet)
ll$LANGUAGE &lt;- as.factor(ll$LANGUAGE)
multi &lt;- multinom(LANGUAGE ~ LOCATION, data=ll)</code></pre>
<pre><code>## # weights:  40 (28 variable)
## initial  value 2145.983671 
## iter  10 value 1081.616009
## iter  20 value 1027.458362
## iter  30 value 1025.668541
## iter  40 value 1025.609658
## iter  50 value 1025.585372
## final  value 1025.584871 
## converged</code></pre>
<pre class="r"><code>summary(multi)</code></pre>
<pre><code>## Call:
## multinom(formula = LANGUAGE ~ LOCATION, data = ll)
## 
## Coefficients:
##                   (Intercept) LOCATION24th LOCATIONMission
## English          3.713392e+00   -1.6606712      -1.1414267
## Equal            9.161193e-01   -1.6633643      -1.2345010
## Other (Chinese) -9.539999e+00   -2.5206831       7.8354395
## Other (Tagalog) -1.005856e+01   -2.9770588       6.9682681
## Other (Thai)    -9.266575e+00    6.3219050      -0.4741931
## Span_Eng        -1.264373e-04    0.3878855       0.3748708
## Spanish          1.945735e+00   -0.3576242      -0.3272004
##                 LOCATIONValencia
## English               -0.1162223
## Equal                -10.6594671
## Other (Chinese)       -2.5346037
## Other (Tagalog)       -2.6799698
## Other (Thai)          -3.8007603
## Span_Eng             -10.0641616
## Spanish               -1.7226796
## 
## Std. Errors:
##                 (Intercept) LOCATION24th LOCATIONMission LOCATIONValencia
## English           0.7156184    0.7559734       0.7490253        0.8768839
## Equal             0.8366090    0.9293296       0.8988160       65.2725028
## Other (Chinese)  83.3773119  126.7018959      83.3790835      225.3583589
## Other (Tagalog) 108.0554714  189.2203510     108.0603056      311.1603627
## Other (Thai)     72.7242951   72.7315331      77.8555077      351.5400629
## Span_Eng          0.9999461    1.0431848       1.0375929       76.6336199
## Spanish           0.7558726    0.7966966       0.7910811        1.0105941
## 
## Residual Deviance: 2051.17 
## AIC: 2107.17</code></pre>
<pre class="r"><code># Get p vals and coefficients
z &lt;- summary(multi)$coefficients/summary(multi)$standard.errors 
p &lt;- (1 - pnorm(abs(z), 0, 1)) * 2 
p</code></pre>
<pre><code>##                  (Intercept) LOCATION24th LOCATIONMission LOCATIONValencia
## English         2.113511e-07   0.02803958       0.1275380       0.89455708
## Equal           2.734997e-01   0.07347739       0.1696048       0.87027660
## Other (Chinese) 9.089052e-01   0.98412746       0.9251301       0.99102639
## Other (Tagalog) 9.258344e-01   0.98744717       0.9485841       0.99312804
## Other (Thai)    8.986075e-01   0.93073423       0.9951404       0.99137365
## Span_Eng        9.998991e-01   0.71002077       0.7178835       0.89551562
## Spanish         1.004847e-02   0.65351549       0.6791585       0.08826521</code></pre>
<pre class="r"><code># Get the odds and coefficients
# exp(coef(multi))</code></pre>
</div>
</div>
</div>
</div>
<div id="gams-1" class="section level2">
<h2>GAMs!</h2>
<p>Let’s turn to GAMs to look at LL distributions.</p>
<pre class="r"><code>gamELL= gam(I(LANGUAGE==&quot;English&quot;)~s(latitude,longitude, k=60) + YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED,family=binomial, data=ll)

gamSLL= gam(I(LANGUAGE==&quot;Spanish&quot;)~s(latitude,longitude, k=60) + YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED,family=binomial, data=ll)

gamESLL= gam(I(LANGUAGE==&quot;Eng_Span&quot;)~s(latitude,longitude, k=60) + YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED,family=binomial, data=ll)

gamSELL= gam(I(LANGUAGE==&quot;Span_Eng&quot;)~s(latitude,longitude, k=60) + YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED,family=binomial, data=ll)

gamEQLL= gam(I(LANGUAGE==&quot;Equal&quot;)~s(latitude,longitude, k=60) + YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED,family=binomial, data=ll)</code></pre>
<div id="gam-diagnostics" class="section level4">
<h4>GAM diagnostics</h4>
<pre class="r"><code>concurvity(gamELL)</code></pre>
<pre><code>##               para s(latitude,longitude)
## worst    0.9993302             0.6214292
## observed 0.9993302             0.3477924
## estimate 0.9993302             0.3560434</code></pre>
<pre class="r"><code>concurvity(gamSLL)</code></pre>
<pre><code>##               para s(latitude,longitude)
## worst    0.9993302             0.6214292
## observed 0.9993302             0.2714755
## estimate 0.9993302             0.3560434</code></pre>
<pre class="r"><code>concurvity(gamESLL)</code></pre>
<pre><code>##               para s(latitude,longitude)
## worst    0.9993302             0.6214292
## observed 0.9993302             0.1284416
## estimate 0.9993302             0.3560434</code></pre>
<pre class="r"><code>concurvity(gamSELL)</code></pre>
<pre><code>##               para s(latitude,longitude)
## worst    0.9993302             0.6214292
## observed 0.9993302             0.3752692
## estimate 0.9993302             0.3560434</code></pre>
<pre class="r"><code>concurvity(gamEQLL)</code></pre>
<pre><code>##               para s(latitude,longitude)
## worst    0.9993302             0.6214292
## observed 0.9993302             0.2880259
## estimate 0.9993302             0.3560434</code></pre>
<pre class="r"><code>gam.check(gamELL)</code></pre>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 2 iterations.
## Gradient range [2.937159e-09,2.937159e-09]
## (score 0.07031652 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.002898905,0.002898905].
## Model rank =  106 / 106 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                           k&#39;    edf k-index p-value
## s(latitude,longitude) 59.000 21.456   0.881       0</code></pre>
<pre class="r"><code>gam.check(gamSLL)</code></pre>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 3 iterations.
## Gradient range [-3.796155e-10,-3.796155e-10]
## (score -0.1045091 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.00330123,0.00330123].
## Model rank =  106 / 106 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                           k&#39;    edf k-index p-value
## s(latitude,longitude) 59.000 35.459   0.887       0</code></pre>
<pre class="r"><code>gam.check(gamESLL)</code></pre>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 2 iterations.
## Gradient range [-5.881589e-09,-5.881589e-09]
## (score -0.5780793 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.001517681,0.001517681].
## Model rank =  106 / 106 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                           k&#39;    edf k-index p-value
## s(latitude,longitude) 59.000 18.706   0.949     0.5</code></pre>
<pre class="r"><code>gam.check(gamSELL)</code></pre>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 4 iterations.
## Gradient range [-6.671218e-08,-6.671218e-08]
## (score -0.5312013 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.001353063,0.001353063].
## Model rank =  106 / 106 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                          k&#39;   edf k-index p-value
## s(latitude,longitude) 59.00  6.55    0.92    0.18</code></pre>
<pre class="r"><code>gam.check(gamEQLL)</code></pre>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 3 iterations.
## Gradient range [-8.346794e-10,-8.346794e-10]
## (score -0.7151074 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.001447556,0.001447556].
## Model rank =  106 / 106 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                           k&#39;    edf k-index p-value
## s(latitude,longitude) 59.000  7.110   0.917    0.24</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-48-1.png" width="672" /><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-48-2.png" width="672" /><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-48-3.png" width="672" /><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-48-4.png" width="672" /><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-48-5.png" width="672" /></p>
</div>
<div id="gam-results" class="section level4">
<h4>GAM results</h4>
<pre class="r"><code># English
summary(gamELL)</code></pre>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## I(LANGUAGE == &quot;English&quot;) ~ s(latitude, longitude, k = 60) + YELP + 
##     COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED
## 
## Parametric coefficients:
##                                               Estimate Std. Error z value
## (Intercept)                                    44.0237 51896.9721   0.001
## YELP                                            0.7416     0.1410   5.260
## COMMUNICATIVE_ROLEEstablishment_Description    -1.0166     0.4430  -2.295
## COMMUNICATIVE_ROLEEstablishment_Name           -0.8597     0.4229  -2.033
## COMMUNICATIVE_ROLEGraffiti                      0.1732     0.7926   0.219
## COMMUNICATIVE_ROLEinformation                 -23.1788 24511.2101  -0.001
## COMMUNICATIVE_ROLEInformation                  -1.3411     0.4417  -3.036
## COMMUNICATIVE_ROLEInstructions                  0.3908     1.4229   0.275
## COMMUNICATIVE_ROLELeaflet                      -1.1885     1.4932  -0.796
## COMMUNICATIVE_ROLESlogan                       -0.9822     1.3350  -0.736
## COMMUNICATIVE_ROLEStreet_Signs                  0.5547     1.0081   0.550
## COMMUNICATIVE_ROLETrademark                    18.4011 48196.1446   0.000
## MATERIALITYHand_Written                         0.6733     0.8570   0.786
## MATERIALITYHome_Printed                         0.5714     0.8598   0.665
## MATERIALITYPermanent                            1.7312     1.0364   1.670
## MATERIALITYProfessionally_Printed               1.4481     0.8451   1.714
## CONTEXT_FRAMEAuto_Mechanic                     -0.6429 51897.1058   0.000
## CONTEXT_FRAMEBakery                           -24.9360 19246.8495  -0.001
## CONTEXT_FRAMEBar                              -22.3820 19246.8495  -0.001
## CONTEXT_FRAMEBeauty_Hair_Salon                -23.2895 19246.8494  -0.001
## CONTEXT_FRAMEBusiness                         -22.4638 19246.8494  -0.001
## CONTEXT_FRAMECafe                              -1.4916 20584.5040   0.000
## CONTEXT_FRAMEClothing                         -23.2780 19246.8495  -0.001
## CONTEXT_FRAMECommentary                       -22.1075 19246.8495  -0.001
## CONTEXT_FRAMEExternal                         -22.5786 19246.8494  -0.001
## CONTEXT_FRAMEFlier                            -45.8507 39139.1784  -0.001
## CONTEXT_FRAMEGallery_Museum                   -24.1304 19246.8495  -0.001
## CONTEXT_FRAMEGrocery                           -2.7168 29903.7031   0.000
## CONTEXT_FRAMEGrocery_Liquor_Store             -23.5920 19246.8494  -0.001
## CONTEXT_FRAMEGym_Fitness_Studio                 0.0302 28792.2798   0.000
## CONTEXT_FRAMEHardware                          -1.9022 29882.6610   0.000
## CONTEXT_FRAMEHotel                            -22.6879 19246.8495  -0.001
## CONTEXT_FRAMEInstitution                      -23.0377 19246.8494  -0.001
## CONTEXT_FRAMEJewelry_Store                    -22.3474 19246.8495  -0.001
## CONTEXT_FRAMELandromat                        -22.3911 19246.8495  -0.001
## CONTEXT_FRAMEMenu                              -5.0706 51897.1058   0.000
## CONTEXT_FRAMEMovie_Theater                    -21.4862 19246.8495  -0.001
## CONTEXT_FRAMENightclub                        -22.0964 19246.8495  -0.001
## CONTEXT_FRAMENotary_Financial_Services        -23.2806 19246.8494  -0.001
## CONTEXT_FRAMEResidential                      -45.3584 32847.9910  -0.001
## CONTEXT_FRAMERestaurant                       -23.8055 19246.8494  -0.001
## CONTEXT_FRAMEShop                             -22.5694 19246.8494  -0.001
## CONTEXT_FRAMESpecialty_Foods                  -22.0218 19246.8495  -0.001
## CONTEXT_FRAMESupermarket                      -23.3643 19246.8494  -0.001
## CONTEXT_FRAMETravel_Agency                    -47.3202 28896.6233  -0.002
## CLOSEDFALSE                                   -21.1499 48196.0008   0.000
## CLOSEDTRUE                                    -21.8697 48196.0008   0.000
##                                             Pr(&gt;|z|)    
## (Intercept)                                  0.99932    
## YELP                                        1.44e-07 ***
## COMMUNICATIVE_ROLEEstablishment_Description  0.02174 *  
## COMMUNICATIVE_ROLEEstablishment_Name         0.04206 *  
## COMMUNICATIVE_ROLEGraffiti                   0.82698    
## COMMUNICATIVE_ROLEinformation                0.99925    
## COMMUNICATIVE_ROLEInformation                0.00239 ** 
## COMMUNICATIVE_ROLEInstructions               0.78358    
## COMMUNICATIVE_ROLELeaflet                    0.42607    
## COMMUNICATIVE_ROLESlogan                     0.46189    
## COMMUNICATIVE_ROLEStreet_Signs               0.58216    
## COMMUNICATIVE_ROLETrademark                  0.99970    
## MATERIALITYHand_Written                      0.43208    
## MATERIALITYHome_Printed                      0.50631    
## MATERIALITYPermanent                         0.09483 .  
## MATERIALITYProfessionally_Printed            0.08661 .  
## CONTEXT_FRAMEAuto_Mechanic                   0.99999    
## CONTEXT_FRAMEBakery                          0.99897    
## CONTEXT_FRAMEBar                             0.99907    
## CONTEXT_FRAMEBeauty_Hair_Salon               0.99903    
## CONTEXT_FRAMEBusiness                        0.99907    
## CONTEXT_FRAMECafe                            0.99994    
## CONTEXT_FRAMEClothing                        0.99904    
## CONTEXT_FRAMECommentary                      0.99908    
## CONTEXT_FRAMEExternal                        0.99906    
## CONTEXT_FRAMEFlier                           0.99907    
## CONTEXT_FRAMEGallery_Museum                  0.99900    
## CONTEXT_FRAMEGrocery                         0.99993    
## CONTEXT_FRAMEGrocery_Liquor_Store            0.99902    
## CONTEXT_FRAMEGym_Fitness_Studio              1.00000    
## CONTEXT_FRAMEHardware                        0.99995    
## CONTEXT_FRAMEHotel                           0.99906    
## CONTEXT_FRAMEInstitution                     0.99904    
## CONTEXT_FRAMEJewelry_Store                   0.99907    
## CONTEXT_FRAMELandromat                       0.99907    
## CONTEXT_FRAMEMenu                            0.99992    
## CONTEXT_FRAMEMovie_Theater                   0.99911    
## CONTEXT_FRAMENightclub                       0.99908    
## CONTEXT_FRAMENotary_Financial_Services       0.99903    
## CONTEXT_FRAMEResidential                     0.99890    
## CONTEXT_FRAMERestaurant                      0.99901    
## CONTEXT_FRAMEShop                            0.99906    
## CONTEXT_FRAMESpecialty_Foods                 0.99909    
## CONTEXT_FRAMESupermarket                     0.99903    
## CONTEXT_FRAMETravel_Agency                   0.99869    
## CLOSEDFALSE                                  0.99965    
## CLOSEDTRUE                                   0.99964    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                         edf Ref.df Chi.sq  p-value    
## s(latitude,longitude) 21.46  28.48  64.21 0.000144 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.266   Deviance explained =   28%
## UBRE = 0.070317  Scale est. = 1         n = 1032</code></pre>
<pre class="r"><code># To get odds ratios (commented out for clarity)
# exp(coef(gamE))

# Spanish
summary(gamSLL)</code></pre>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## I(LANGUAGE == &quot;Spanish&quot;) ~ s(latitude, longitude, k = 60) + YELP + 
##     COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED
## 
## Parametric coefficients:
##                                               Estimate Std. Error z value
## (Intercept)                                 -5.187e+01  6.352e+05   0.000
## YELP                                        -6.091e-01  1.745e-01  -3.490
## COMMUNICATIVE_ROLEEstablishment_Description  5.948e-01  5.321e-01   1.118
## COMMUNICATIVE_ROLEEstablishment_Name         5.442e-01  5.122e-01   1.063
## COMMUNICATIVE_ROLEGraffiti                  -2.188e+00  1.106e+00  -1.978
## COMMUNICATIVE_ROLEinformation               -1.127e-01  1.416e+00  -0.080
## COMMUNICATIVE_ROLEInformation                3.734e-01  5.304e-01   0.704
## COMMUNICATIVE_ROLEInstructions               3.725e-01  1.602e+00   0.233
## COMMUNICATIVE_ROLELeaflet                   -1.945e-01  1.445e+00  -0.135
## COMMUNICATIVE_ROLESlogan                     2.172e-01  1.458e+00   0.149
## COMMUNICATIVE_ROLEStreet_Signs              -8.371e-01  1.373e+00  -0.610
## COMMUNICATIVE_ROLETrademark                 -2.306e+01  5.871e+05   0.000
## MATERIALITYHand_Written                     -9.566e-01  9.062e-01  -1.056
## MATERIALITYHome_Printed                     -1.217e+00  9.193e-01  -1.324
## MATERIALITYPermanent                        -2.994e+00  1.254e+00  -2.388
## MATERIALITYProfessionally_Printed           -2.166e+00  8.988e-01  -2.410
## CONTEXT_FRAMEAuto_Mechanic                   9.136e-01  6.351e+05   0.000
## CONTEXT_FRAMEBakery                          2.950e+01  2.420e+05   0.000
## CONTEXT_FRAMEBar                             2.672e+01  2.420e+05   0.000
## CONTEXT_FRAMEBeauty_Hair_Salon               2.752e+01  2.420e+05   0.000
## CONTEXT_FRAMEBusiness                        2.676e+01  2.420e+05   0.000
## CONTEXT_FRAMECafe                            1.552e+00  2.580e+05   0.000
## CONTEXT_FRAMEClothing                        2.849e+01  2.420e+05   0.000
## CONTEXT_FRAMECommentary                      2.818e+01  2.420e+05   0.000
## CONTEXT_FRAMEExternal                        2.729e+01  2.420e+05   0.000
## CONTEXT_FRAMEFlier                           5.829e+01  4.805e+05   0.000
## CONTEXT_FRAMEGallery_Museum                  2.657e+01  2.420e+05   0.000
## CONTEXT_FRAMEGrocery                         3.085e+00  3.651e+05   0.000
## CONTEXT_FRAMEGrocery_Liquor_Store            2.732e+01  2.420e+05   0.000
## CONTEXT_FRAMEGym_Fitness_Studio             -6.323e-02  3.655e+05   0.000
## CONTEXT_FRAMEHardware                        1.891e+00  3.722e+05   0.000
## CONTEXT_FRAMEHotel                           1.565e+00  2.992e+05   0.000
## CONTEXT_FRAMEInstitution                     2.809e+01  2.420e+05   0.000
## CONTEXT_FRAMEJewelry_Store                   2.580e+01  2.420e+05   0.000
## CONTEXT_FRAMELandromat                       2.648e+01  2.420e+05   0.000
## CONTEXT_FRAMEMenu                            6.346e+00  6.351e+05   0.000
## CONTEXT_FRAMEMovie_Theater                   2.658e+01  2.420e+05   0.000
## CONTEXT_FRAMENightclub                       1.394e+00  3.179e+05   0.000
## CONTEXT_FRAMENotary_Financial_Services       2.759e+01  2.420e+05   0.000
## CONTEXT_FRAMEResidential                     5.575e+01  3.985e+05   0.000
## CONTEXT_FRAMERestaurant                      2.805e+01  2.420e+05   0.000
## CONTEXT_FRAMEShop                            2.635e+01  2.420e+05   0.000
## CONTEXT_FRAMESpecialty_Foods                 2.655e+01  2.420e+05   0.000
## CONTEXT_FRAMESupermarket                     2.723e+01  2.420e+05   0.000
## CONTEXT_FRAMETravel_Agency                   3.183e+01  2.420e+05   0.000
## CLOSEDFALSE                                  2.481e+01  5.873e+05   0.000
## CLOSEDTRUE                                   2.529e+01  5.873e+05   0.000
##                                             Pr(&gt;|z|)    
## (Intercept)                                 0.999935    
## YELP                                        0.000482 ***
## COMMUNICATIVE_ROLEEstablishment_Description 0.263683    
## COMMUNICATIVE_ROLEEstablishment_Name        0.288004    
## COMMUNICATIVE_ROLEGraffiti                  0.047951 *  
## COMMUNICATIVE_ROLEinformation               0.936542    
## COMMUNICATIVE_ROLEInformation               0.481422    
## COMMUNICATIVE_ROLEInstructions              0.816079    
## COMMUNICATIVE_ROLELeaflet                   0.892933    
## COMMUNICATIVE_ROLESlogan                    0.881545    
## COMMUNICATIVE_ROLEStreet_Signs              0.541943    
## COMMUNICATIVE_ROLETrademark                 0.999969    
## MATERIALITYHand_Written                     0.291186    
## MATERIALITYHome_Printed                     0.185457    
## MATERIALITYPermanent                        0.016922 *  
## MATERIALITYProfessionally_Printed           0.015944 *  
## CONTEXT_FRAMEAuto_Mechanic                  0.999999    
## CONTEXT_FRAMEBakery                         0.999903    
## CONTEXT_FRAMEBar                            0.999912    
## CONTEXT_FRAMEBeauty_Hair_Salon              0.999909    
## CONTEXT_FRAMEBusiness                       0.999912    
## CONTEXT_FRAMECafe                           0.999995    
## CONTEXT_FRAMEClothing                       0.999906    
## CONTEXT_FRAMECommentary                     0.999907    
## CONTEXT_FRAMEExternal                       0.999910    
## CONTEXT_FRAMEFlier                          0.999903    
## CONTEXT_FRAMEGallery_Museum                 0.999912    
## CONTEXT_FRAMEGrocery                        0.999993    
## CONTEXT_FRAMEGrocery_Liquor_Store           0.999910    
## CONTEXT_FRAMEGym_Fitness_Studio             1.000000    
## CONTEXT_FRAMEHardware                       0.999996    
## CONTEXT_FRAMEHotel                          0.999996    
## CONTEXT_FRAMEInstitution                    0.999907    
## CONTEXT_FRAMEJewelry_Store                  0.999915    
## CONTEXT_FRAMELandromat                      0.999913    
## CONTEXT_FRAMEMenu                           0.999992    
## CONTEXT_FRAMEMovie_Theater                  0.999912    
## CONTEXT_FRAMENightclub                      0.999997    
## CONTEXT_FRAMENotary_Financial_Services      0.999909    
## CONTEXT_FRAMEResidential                    0.999888    
## CONTEXT_FRAMERestaurant                     0.999908    
## CONTEXT_FRAMEShop                           0.999913    
## CONTEXT_FRAMESpecialty_Foods                0.999912    
## CONTEXT_FRAMESupermarket                    0.999910    
## CONTEXT_FRAMETravel_Agency                  0.999895    
## CLOSEDFALSE                                 0.999966    
## CLOSEDTRUE                                  0.999966    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                         edf Ref.df Chi.sq p-value   
## s(latitude,longitude) 35.46   43.9  72.91 0.00415 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.243   Deviance explained = 29.5%
## UBRE = -0.10451  Scale est. = 1         n = 1032</code></pre>
<pre class="r"><code># Odds ratios
# exp(coef(gamES))

# Mostly English with Some Spanish
# Spanish
summary(gamESLL)</code></pre>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## I(LANGUAGE == &quot;Eng_Span&quot;) ~ s(latitude, longitude, k = 60) + 
##     YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + 
##     CLOSED
## 
## Parametric coefficients:
##                                               Estimate Std. Error z value
## (Intercept)                                 -7.440e+01  4.502e+05   0.000
## YELP                                         4.208e-03  2.567e-01   0.016
## COMMUNICATIVE_ROLEEstablishment_Description  9.883e-01  1.150e+00   0.860
## COMMUNICATIVE_ROLEEstablishment_Name         1.158e+00  1.112e+00   1.041
## COMMUNICATIVE_ROLEGraffiti                   2.157e+00  1.442e+00   1.496
## COMMUNICATIVE_ROLEinformation               -2.275e+01  2.287e+05   0.000
## COMMUNICATIVE_ROLEInformation                1.488e+00  1.131e+00   1.316
## COMMUNICATIVE_ROLEInstructions              -2.221e+01  1.465e+05   0.000
## COMMUNICATIVE_ROLELeaflet                   -1.970e+01  1.068e+05   0.000
## COMMUNICATIVE_ROLESlogan                     3.117e+00  1.712e+00   1.821
## COMMUNICATIVE_ROLEStreet_Signs              -2.277e+01  7.992e+04   0.000
## COMMUNICATIVE_ROLETrademark                 -2.167e+01  4.078e+05   0.000
## MATERIALITYHand_Written                      2.143e+01  8.507e+04   0.000
## MATERIALITYHome_Printed                      2.057e+01  8.507e+04   0.000
## MATERIALITYPermanent                         2.155e+01  8.507e+04   0.000
## MATERIALITYProfessionally_Printed            2.131e+01  8.507e+04   0.000
## CONTEXT_FRAMEAuto_Mechanic                   1.795e+00  4.421e+05   0.000
## CONTEXT_FRAMEBakery                          2.402e+01  1.707e+05   0.000
## CONTEXT_FRAMEBar                             3.610e-01  1.884e+05   0.000
## CONTEXT_FRAMEBeauty_Hair_Salon               2.429e+01  1.707e+05   0.000
## CONTEXT_FRAMEBusiness                        2.354e+01  1.707e+05   0.000
## CONTEXT_FRAMECafe                            5.885e-01  1.834e+05   0.000
## CONTEXT_FRAMEClothing                        6.496e-02  1.935e+05   0.000
## CONTEXT_FRAMECommentary                      2.744e-01  1.982e+05   0.000
## CONTEXT_FRAMEExternal                        2.429e+01  1.707e+05   0.000
## CONTEXT_FRAMEFlier                           2.057e+01  3.517e+05   0.000
## CONTEXT_FRAMEGallery_Museum                  2.447e+01  1.707e+05   0.000
## CONTEXT_FRAMEGrocery                         6.510e-01  2.611e+05   0.000
## CONTEXT_FRAMEGrocery_Liquor_Store            2.496e+01  1.707e+05   0.000
## CONTEXT_FRAMEGym_Fitness_Studio              7.352e-01  2.615e+05   0.000
## CONTEXT_FRAMEHardware                        6.482e-01  2.636e+05   0.000
## CONTEXT_FRAMEHotel                           2.572e+01  1.707e+05   0.000
## CONTEXT_FRAMEInstitution                     1.031e+00  1.925e+05   0.000
## CONTEXT_FRAMEJewelry_Store                   2.431e+01  1.707e+05   0.000
## CONTEXT_FRAMELandromat                       2.533e+01  1.707e+05   0.000
## CONTEXT_FRAMEMenu                            1.820e+00  4.421e+05   0.000
## CONTEXT_FRAMEMovie_Theater                   1.285e-01  2.191e+05   0.000
## CONTEXT_FRAMENightclub                       2.516e+01  1.707e+05   0.000
## CONTEXT_FRAMENotary_Financial_Services       5.360e-01  1.964e+05   0.000
## CONTEXT_FRAMEResidential                     8.533e-01  2.642e+05   0.000
## CONTEXT_FRAMERestaurant                      2.431e+01  1.707e+05   0.000
## CONTEXT_FRAMEShop                            2.440e+01  1.707e+05   0.000
## CONTEXT_FRAMESpecialty_Foods                 9.096e-01  2.038e+05   0.000
## CONTEXT_FRAMESupermarket                     2.522e+01  1.707e+05   0.000
## CONTEXT_FRAMETravel_Agency                   1.447e+00  2.498e+05   0.000
## CLOSEDFALSE                                  2.440e+01  4.078e+05   0.000
## CLOSEDTRUE                                   2.556e+01  4.078e+05   0.000
##                                             Pr(&gt;|z|)  
## (Intercept)                                   0.9999  
## YELP                                          0.9869  
## COMMUNICATIVE_ROLEEstablishment_Description   0.3900  
## COMMUNICATIVE_ROLEEstablishment_Name          0.2980  
## COMMUNICATIVE_ROLEGraffiti                    0.1348  
## COMMUNICATIVE_ROLEinformation                 0.9999  
## COMMUNICATIVE_ROLEInformation                 0.1881  
## COMMUNICATIVE_ROLEInstructions                0.9999  
## COMMUNICATIVE_ROLELeaflet                     0.9999  
## COMMUNICATIVE_ROLESlogan                      0.0686 .
## COMMUNICATIVE_ROLEStreet_Signs                0.9998  
## COMMUNICATIVE_ROLETrademark                   1.0000  
## MATERIALITYHand_Written                       0.9998  
## MATERIALITYHome_Printed                       0.9998  
## MATERIALITYPermanent                          0.9998  
## MATERIALITYProfessionally_Printed             0.9998  
## CONTEXT_FRAMEAuto_Mechanic                    1.0000  
## CONTEXT_FRAMEBakery                           0.9999  
## CONTEXT_FRAMEBar                              1.0000  
## CONTEXT_FRAMEBeauty_Hair_Salon                0.9999  
## CONTEXT_FRAMEBusiness                         0.9999  
## CONTEXT_FRAMECafe                             1.0000  
## CONTEXT_FRAMEClothing                         1.0000  
## CONTEXT_FRAMECommentary                       1.0000  
## CONTEXT_FRAMEExternal                         0.9999  
## CONTEXT_FRAMEFlier                            1.0000  
## CONTEXT_FRAMEGallery_Museum                   0.9999  
## CONTEXT_FRAMEGrocery                          1.0000  
## CONTEXT_FRAMEGrocery_Liquor_Store             0.9999  
## CONTEXT_FRAMEGym_Fitness_Studio               1.0000  
## CONTEXT_FRAMEHardware                         1.0000  
## CONTEXT_FRAMEHotel                            0.9999  
## CONTEXT_FRAMEInstitution                      1.0000  
## CONTEXT_FRAMEJewelry_Store                    0.9999  
## CONTEXT_FRAMELandromat                        0.9999  
## CONTEXT_FRAMEMenu                             1.0000  
## CONTEXT_FRAMEMovie_Theater                    1.0000  
## CONTEXT_FRAMENightclub                        0.9999  
## CONTEXT_FRAMENotary_Financial_Services        1.0000  
## CONTEXT_FRAMEResidential                      1.0000  
## CONTEXT_FRAMERestaurant                       0.9999  
## CONTEXT_FRAMEShop                             0.9999  
## CONTEXT_FRAMESpecialty_Foods                  1.0000  
## CONTEXT_FRAMESupermarket                      0.9999  
## CONTEXT_FRAMETravel_Agency                    1.0000  
## CLOSEDFALSE                                   1.0000  
## CLOSEDTRUE                                    0.9999  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                         edf Ref.df Chi.sq p-value
## s(latitude,longitude) 18.71  25.06  23.19   0.568
## 
## R-sq.(adj) =  0.041   Deviance explained = 20.5%
## UBRE = -0.57808  Scale est. = 1         n = 1032</code></pre>
<pre class="r"><code># Odds ratios
# exp(coef(gamES))

# Mostly Spanish with some English
summary(gamSELL)</code></pre>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## I(LANGUAGE == &quot;Span_Eng&quot;) ~ s(latitude, longitude, k = 60) + 
##     YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + 
##     CLOSED
## 
## Parametric coefficients:
##                                               Estimate Std. Error z value
## (Intercept)                                 -1.219e+02  3.702e+07   0.000
## YELP                                        -9.442e-01  2.748e-01  -3.436
## COMMUNICATIVE_ROLEEstablishment_Description  1.607e+00  1.093e+00   1.470
## COMMUNICATIVE_ROLEEstablishment_Name         1.024e+00  1.079e+00   0.949
## COMMUNICATIVE_ROLEGraffiti                  -2.759e+01  1.917e+07   0.000
## COMMUNICATIVE_ROLEinformation                2.203e+00  1.728e+00   1.274
## COMMUNICATIVE_ROLEInformation                1.501e+00  1.109e+00   1.354
## COMMUNICATIVE_ROLEInstructions              -9.506e-01  2.834e+07   0.000
## COMMUNICATIVE_ROLELeaflet                   -2.553e+01  3.663e+07   0.000
## COMMUNICATIVE_ROLESlogan                    -3.002e+01  2.740e+07   0.000
## COMMUNICATIVE_ROLEStreet_Signs              -2.743e+01  3.036e+06   0.000
## COMMUNICATIVE_ROLETrademark                 -2.870e+01  6.711e+07   0.000
## MATERIALITYHand_Written                      3.043e+01  2.167e+07   0.000
## MATERIALITYHome_Printed                      3.140e+01  2.167e+07   0.000
## MATERIALITYPermanent                         3.166e+01  2.167e+07   0.000
## MATERIALITYProfessionally_Printed            3.120e+01  2.167e+07   0.000
## CONTEXT_FRAMEAuto_Mechanic                   4.002e+01  7.351e+07   0.000
## CONTEXT_FRAMEBakery                          7.124e+01  3.001e+07   0.000
## CONTEXT_FRAMEBar                             7.258e+01  3.001e+07   0.000
## CONTEXT_FRAMEBeauty_Hair_Salon               7.214e+01  3.001e+07   0.000
## CONTEXT_FRAMEBusiness                        7.179e+01  3.001e+07   0.000
## CONTEXT_FRAMECafe                            4.060e+01  3.221e+07   0.000
## CONTEXT_FRAMEClothing                        7.157e+01  3.001e+07   0.000
## CONTEXT_FRAMECommentary                      4.359e+01  4.121e+07   0.000
## CONTEXT_FRAMEExternal                        4.199e+01  3.107e+07   0.000
## CONTEXT_FRAMEFlier                           6.552e+01  6.704e+07   0.000
## CONTEXT_FRAMEGallery_Museum                  7.347e+01  3.001e+07   0.000
## CONTEXT_FRAMEGrocery                         4.239e+01  4.502e+07   0.000
## CONTEXT_FRAMEGrocery_Liquor_Store            7.224e+01  3.001e+07   0.000
## CONTEXT_FRAMEGym_Fitness_Studio              3.940e+01  4.502e+07   0.000
## CONTEXT_FRAMEHardware                        4.143e+01  4.502e+07   0.000
## CONTEXT_FRAMEHotel                           4.115e+01  3.676e+07   0.000
## CONTEXT_FRAMEInstitution                     3.949e+01  3.373e+07   0.000
## CONTEXT_FRAMEJewelry_Store                   7.331e+01  3.001e+07   0.000
## CONTEXT_FRAMELandromat                       7.152e+01  3.001e+07   0.000
## CONTEXT_FRAMEMenu                            4.482e+01  7.351e+07   0.000
## CONTEXT_FRAMEMovie_Theater                   4.067e+01  3.826e+07   0.000
## CONTEXT_FRAMENightclub                       4.036e+01  3.929e+07   0.000
## CONTEXT_FRAMENotary_Financial_Services       7.042e+01  3.001e+07   0.000
## CONTEXT_FRAMEResidential                     4.161e+01  5.024e+07   0.000
## CONTEXT_FRAMERestaurant                      7.267e+01  3.001e+07   0.000
## CONTEXT_FRAMEShop                            7.233e+01  3.001e+07   0.000
## CONTEXT_FRAMESpecialty_Foods                 4.140e+01  3.580e+07   0.000
## CONTEXT_FRAMESupermarket                     7.308e+01  3.001e+07   0.000
## CONTEXT_FRAMETravel_Agency                   7.418e+01  3.001e+07   0.000
## CLOSEDFALSE                                  1.528e+01  6.242e+03   0.002
## CLOSEDTRUE                                   1.474e+01  6.242e+03   0.002
##                                             Pr(&gt;|z|)    
## (Intercept)                                  1.00000    
## YELP                                         0.00059 ***
## COMMUNICATIVE_ROLEEstablishment_Description  0.14161    
## COMMUNICATIVE_ROLEEstablishment_Name         0.34273    
## COMMUNICATIVE_ROLEGraffiti                   1.00000    
## COMMUNICATIVE_ROLEinformation                0.20249    
## COMMUNICATIVE_ROLEInformation                0.17569    
## COMMUNICATIVE_ROLEInstructions               1.00000    
## COMMUNICATIVE_ROLELeaflet                    1.00000    
## COMMUNICATIVE_ROLESlogan                     1.00000    
## COMMUNICATIVE_ROLEStreet_Signs               0.99999    
## COMMUNICATIVE_ROLETrademark                  1.00000    
## MATERIALITYHand_Written                      1.00000    
## MATERIALITYHome_Printed                      1.00000    
## MATERIALITYPermanent                         1.00000    
## MATERIALITYProfessionally_Printed            1.00000    
## CONTEXT_FRAMEAuto_Mechanic                   1.00000    
## CONTEXT_FRAMEBakery                          1.00000    
## CONTEXT_FRAMEBar                             1.00000    
## CONTEXT_FRAMEBeauty_Hair_Salon               1.00000    
## CONTEXT_FRAMEBusiness                        1.00000    
## CONTEXT_FRAMECafe                            1.00000    
## CONTEXT_FRAMEClothing                        1.00000    
## CONTEXT_FRAMECommentary                      1.00000    
## CONTEXT_FRAMEExternal                        1.00000    
## CONTEXT_FRAMEFlier                           1.00000    
## CONTEXT_FRAMEGallery_Museum                  1.00000    
## CONTEXT_FRAMEGrocery                         1.00000    
## CONTEXT_FRAMEGrocery_Liquor_Store            1.00000    
## CONTEXT_FRAMEGym_Fitness_Studio              1.00000    
## CONTEXT_FRAMEHardware                        1.00000    
## CONTEXT_FRAMEHotel                           1.00000    
## CONTEXT_FRAMEInstitution                     1.00000    
## CONTEXT_FRAMEJewelry_Store                   1.00000    
## CONTEXT_FRAMELandromat                       1.00000    
## CONTEXT_FRAMEMenu                            1.00000    
## CONTEXT_FRAMEMovie_Theater                   1.00000    
## CONTEXT_FRAMENightclub                       1.00000    
## CONTEXT_FRAMENotary_Financial_Services       1.00000    
## CONTEXT_FRAMEResidential                     1.00000    
## CONTEXT_FRAMERestaurant                      1.00000    
## CONTEXT_FRAMEShop                            1.00000    
## CONTEXT_FRAMESpecialty_Foods                 1.00000    
## CONTEXT_FRAMESupermarket                     1.00000    
## CONTEXT_FRAMETravel_Agency                   1.00000    
## CLOSEDFALSE                                  0.99805    
## CLOSEDTRUE                                   0.99812    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                         edf Ref.df Chi.sq p-value  
## s(latitude,longitude) 6.546  9.113  15.16  0.0895 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0607   Deviance explained = 19.7%
## UBRE = -0.5312  Scale est. = 1         n = 1032</code></pre>
<pre class="r"><code># Odds ratios
# exp(coef(gamSE))

# Equal
summary(gamEQLL)</code></pre>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## I(LANGUAGE == &quot;Equal&quot;) ~ s(latitude, longitude, k = 60) + YELP + 
##     COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED
## 
## Parametric coefficients:
##                                               Estimate Std. Error z value
## (Intercept)                                 -8.083e+01  2.224e+06   0.000
## YELP                                        -1.041e+00  4.483e-01  -2.322
## COMMUNICATIVE_ROLEEstablishment_Description -3.665e-01  1.036e+00  -0.354
## COMMUNICATIVE_ROLEEstablishment_Name        -1.530e-01  9.492e-01  -0.161
## COMMUNICATIVE_ROLEGraffiti                   1.354e+00  1.562e+00   0.867
## COMMUNICATIVE_ROLEinformation                3.844e+00  1.737e+00   2.212
## COMMUNICATIVE_ROLEInformation                1.634e+00  9.271e-01   1.762
## COMMUNICATIVE_ROLEInstructions              -2.572e+01  6.156e+05   0.000
## COMMUNICATIVE_ROLELeaflet                   -2.445e+01  4.656e+05   0.000
## COMMUNICATIVE_ROLESlogan                    -2.640e+01  6.700e+05   0.000
## COMMUNICATIVE_ROLEStreet_Signs               2.472e+00  2.320e+00   1.066
## COMMUNICATIVE_ROLETrademark                 -2.287e+01  2.033e+06   0.000
## MATERIALITYHand_Written                      2.674e+01  4.162e+05   0.000
## MATERIALITYHome_Printed                      2.704e+01  4.162e+05   0.000
## MATERIALITYPermanent                         2.494e+01  4.162e+05   0.000
## MATERIALITYProfessionally_Printed            2.639e+01  4.162e+05   0.000
## CONTEXT_FRAMEAuto_Mechanic                  -2.323e+00  2.184e+06   0.000
## CONTEXT_FRAMEBakery                          2.667e+01  7.987e+05   0.000
## CONTEXT_FRAMEBar                             2.817e-01  8.847e+05   0.000
## CONTEXT_FRAMEBeauty_Hair_Salon              -6.883e-01  8.407e+05   0.000
## CONTEXT_FRAMEBusiness                        2.493e+01  7.987e+05   0.000
## CONTEXT_FRAMECafe                           -2.876e-01  8.560e+05   0.000
## CONTEXT_FRAMEClothing                       -1.417e+00  8.909e+05   0.000
## CONTEXT_FRAMECommentary                     -1.986e+00  9.232e+05   0.000
## CONTEXT_FRAMEExternal                        2.376e+01  7.987e+05   0.000
## CONTEXT_FRAMEFlier                           2.326e+01  1.709e+06   0.000
## CONTEXT_FRAMEGallery_Museum                  2.653e+01  7.987e+05   0.000
## CONTEXT_FRAMEGrocery                         8.718e-01  1.289e+06   0.000
## CONTEXT_FRAMEGrocery_Liquor_Store            2.614e+01  7.987e+05   0.000
## CONTEXT_FRAMEGym_Fitness_Studio             -1.957e+00  1.271e+06   0.000
## CONTEXT_FRAMEHardware                       -3.103e-01  1.247e+06   0.000
## CONTEXT_FRAMEHotel                           2.717e+01  7.987e+05   0.000
## CONTEXT_FRAMEInstitution                     2.406e+01  7.987e+05   0.000
## CONTEXT_FRAMEJewelry_Store                  -1.158e+00  9.500e+05   0.000
## CONTEXT_FRAMELandromat                      -8.332e-01  9.580e+05   0.000
## CONTEXT_FRAMEMenu                            3.488e-01  2.184e+06   0.000
## CONTEXT_FRAMEMovie_Theater                  -1.482e+00  1.035e+06   0.000
## CONTEXT_FRAMENightclub                      -2.489e-01  1.057e+06   0.000
## CONTEXT_FRAMENotary_Financial_Services       2.650e+01  7.987e+05   0.000
## CONTEXT_FRAMEResidential                    -1.179e+00  1.269e+06   0.000
## CONTEXT_FRAMERestaurant                      2.383e+01  7.987e+05   0.000
## CONTEXT_FRAMEShop                            2.496e+01  7.987e+05   0.000
## CONTEXT_FRAMESpecialty_Foods                -1.884e-01  9.262e+05   0.000
## CONTEXT_FRAMESupermarket                     2.449e+01  7.987e+05   0.000
## CONTEXT_FRAMETravel_Agency                  -1.314e+00  1.210e+06   0.000
## CLOSEDFALSE                                  2.602e+01  2.033e+06   0.000
## CLOSEDTRUE                                   1.650e+00  2.046e+06   0.000
##                                             Pr(&gt;|z|)  
## (Intercept)                                   1.0000  
## YELP                                          0.0202 *
## COMMUNICATIVE_ROLEEstablishment_Description   0.7235  
## COMMUNICATIVE_ROLEEstablishment_Name          0.8720  
## COMMUNICATIVE_ROLEGraffiti                    0.3862  
## COMMUNICATIVE_ROLEinformation                 0.0269 *
## COMMUNICATIVE_ROLEInformation                 0.0781 .
## COMMUNICATIVE_ROLEInstructions                1.0000  
## COMMUNICATIVE_ROLELeaflet                     1.0000  
## COMMUNICATIVE_ROLESlogan                      1.0000  
## COMMUNICATIVE_ROLEStreet_Signs                0.2866  
## COMMUNICATIVE_ROLETrademark                   1.0000  
## MATERIALITYHand_Written                       0.9999  
## MATERIALITYHome_Printed                       0.9999  
## MATERIALITYPermanent                          1.0000  
## MATERIALITYProfessionally_Printed             0.9999  
## CONTEXT_FRAMEAuto_Mechanic                    1.0000  
## CONTEXT_FRAMEBakery                           1.0000  
## CONTEXT_FRAMEBar                              1.0000  
## CONTEXT_FRAMEBeauty_Hair_Salon                1.0000  
## CONTEXT_FRAMEBusiness                         1.0000  
## CONTEXT_FRAMECafe                             1.0000  
## CONTEXT_FRAMEClothing                         1.0000  
## CONTEXT_FRAMECommentary                       1.0000  
## CONTEXT_FRAMEExternal                         1.0000  
## CONTEXT_FRAMEFlier                            1.0000  
## CONTEXT_FRAMEGallery_Museum                   1.0000  
## CONTEXT_FRAMEGrocery                          1.0000  
## CONTEXT_FRAMEGrocery_Liquor_Store             1.0000  
## CONTEXT_FRAMEGym_Fitness_Studio               1.0000  
## CONTEXT_FRAMEHardware                         1.0000  
## CONTEXT_FRAMEHotel                            1.0000  
## CONTEXT_FRAMEInstitution                      1.0000  
## CONTEXT_FRAMEJewelry_Store                    1.0000  
## CONTEXT_FRAMELandromat                        1.0000  
## CONTEXT_FRAMEMenu                             1.0000  
## CONTEXT_FRAMEMovie_Theater                    1.0000  
## CONTEXT_FRAMENightclub                        1.0000  
## CONTEXT_FRAMENotary_Financial_Services        1.0000  
## CONTEXT_FRAMEResidential                      1.0000  
## CONTEXT_FRAMERestaurant                       1.0000  
## CONTEXT_FRAMEShop                             1.0000  
## CONTEXT_FRAMESpecialty_Foods                  1.0000  
## CONTEXT_FRAMESupermarket                      1.0000  
## CONTEXT_FRAMETravel_Agency                    1.0000  
## CLOSEDFALSE                                   1.0000  
## CLOSEDTRUE                                    1.0000  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                        edf Ref.df Chi.sq p-value
## s(latitude,longitude) 7.11  9.628  15.22   0.102
## 
## R-sq.(adj) =  0.144   Deviance explained = 31.5%
## UBRE = -0.71511  Scale est. = 1         n = 1032</code></pre>
<pre class="r"><code># Odds ratios
# exp(coef(gamEQ))</code></pre>
<p>We can see from these results a lot of information – what is significant, deviance explained, coefficients, etc. But it is also useful to plot probabilities.</p>
<pre class="r"><code># Plot probabilities? (Adapted from http://myweb.uiowa.edu/pbreheny/publications/visreg.pdf)
library(visreg)
# We will just look at those flagged as &#39;significant&#39;
# Probability of English by coordinate
visreg2d(gamELL, &quot;longitude&quot;, &quot;latitude&quot;, plot.type=&quot;image&quot;)</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<pre class="r"><code># Spanish
visreg2d(gamSLL, &quot;longitude&quot;, &quot;latitude&quot;, plot.type=&quot;image&quot;)</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-50-2.png" width="672" /></p>
</div>
<div id="combining-ll-and-instagram-data" class="section level3">
<h3>Combining LL and Instagram Data</h3>
<p>Remember to remind R that your ‘Mode’ is actually a category, not a continuous variable.</p>
<pre class="r"><code>topicsigns$YELP &lt;- as.factor(topicsigns$YELP)
topicsigns$Topic &lt;- as.factor(topicsigns$Topic)

# Subset to get rid of Trademark with has no observations
topicsigns&lt;-subset(topicsigns, COMMUNICATIVE_ROLE==&quot;Establishment_Name&quot; | COMMUNICATIVE_ROLE ==&quot;Establishment_Description&quot;| COMMUNICATIVE_ROLE==&quot;Graffiti&quot;| COMMUNICATIVE_ROLE==&quot;Advertisement&quot;| COMMUNICATIVE_ROLE==&quot;Information&quot;| COMMUNICATIVE_ROLE==&quot;Instructions&quot;| COMMUNICATIVE_ROLE==&quot;Leaflet&quot;| COMMUNICATIVE_ROLE==&quot;Slogan&quot;| COMMUNICATIVE_ROLE==&quot;Street_Signs&quot;)

# On to the first GAM!
# We have adjusted k to 40.
# English
gamE= gam(I(LANGUAGE==&quot;English&quot;)~s(latitude,longitude, k=60) + YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED + Topic,family=binomial, data=topicsigns)

# Spanish
gamS= gam(I(LANGUAGE==&quot;Spanish&quot;)~s(latitude,longitude, k=60) + YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED + Topic,family=binomial, data=topicsigns)

# Mostly English with some Spanish
gamES = gam(I(LANGUAGE==&quot;Eng_Span&quot;)~s(latitude,longitude, k=60) + YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED + Topic,family=binomial, data=topicsigns)

# Mostly Spanish with some English
gamSE = gam(I(LANGUAGE==&quot;Span_Eng&quot;)~s(latitude,longitude, k=60) + YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED + Topic,family=binomial, data=topicsigns)

# Equal
gamEQ = gam(I(LANGUAGE==&quot;Equal&quot;)~s(latitude,longitude, k=60) + YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED + Topic,family=binomial, data=topicsigns)</code></pre>
</div>
<div id="model-checking" class="section level3">
<h3>Model checking</h3>
<p>It’s also time to check for concurvity, to see if <a href="https://stat.ethz.ch/R-manual/R-devel/library/mgcv/html/concurvity.html">“a smooth term in [my] model could be approximated by one or more of the other smooth terms in the model”</a>. I think I am potentially at risk for this perhaps as “this is often the case when a smooth of space is included in a model, along with smooths of other covariates that also vary more or less smoothly in space”.</p>
<pre class="r"><code>concurvity(gamE)</code></pre>
<pre><code>##               para s(latitude,longitude)
## worst    0.9995429             0.8130711
## observed 0.9995429             0.4924878
## estimate 0.9995429             0.4007821</code></pre>
<pre class="r"><code>concurvity(gamS)</code></pre>
<pre><code>##               para s(latitude,longitude)
## worst    0.9995429             0.8130711
## observed 0.9995429             0.4332782
## estimate 0.9995429             0.4007821</code></pre>
<pre class="r"><code>concurvity(gamES)</code></pre>
<pre><code>##               para s(latitude,longitude)
## worst    0.9995429             0.8130711
## observed 0.9995429             0.3382393
## estimate 0.9995429             0.4007821</code></pre>
<pre class="r"><code>concurvity(gamSE)</code></pre>
<pre><code>##               para s(latitude,longitude)
## worst    0.9995429             0.8130711
## observed 0.9995429             0.5602935
## estimate 0.9995429             0.4007821</code></pre>
<pre class="r"><code>concurvity(gamEQ)</code></pre>
<pre><code>##               para s(latitude,longitude)
## worst    0.9995429             0.8130711
## observed 0.9995429             0.4685437
## estimate 0.9995429             0.4007821</code></pre>
<p>Concurvity measures suggest that my smooths are okay – they are all pretty far away from 1.</p>
<p>Now onto gam.check to look at more diagnostics. There is an issue here where the k-index is less than 1 for these models, but this doesn’t get solved until k is up to around 300 or so, which would not be the best solution (would make the model prone to over-fitting!). So, while these suggest k is too low, I keep k as is to not over fit the model.</p>
<pre class="r"><code>gam.check(gamE)</code></pre>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 3 iterations.
## Gradient range [2.738027e-09,2.738027e-09]
## (score 0.04053542 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.001719122,0.001719122].
## Model rank =  126 / 126 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                           k&#39;    edf k-index p-value
## s(latitude,longitude) 59.000 20.107   0.938    0.02</code></pre>
<pre class="r"><code>gam.check(gamS)</code></pre>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 9 iterations.
## Gradient range [2.463495e-07,2.463495e-07]
## (score -0.172996 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.002485206,0.002485206].
## Model rank =  126 / 126 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                          k&#39;   edf k-index p-value
## s(latitude,longitude) 59.00 57.96    1.07    0.98</code></pre>
<pre class="r"><code>gam.check(gamES)</code></pre>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 3 iterations.
## Gradient range [-5.25853e-09,-5.25853e-09]
## (score -0.5617174 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.002522951,0.002522951].
## Model rank =  126 / 126 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                          k&#39;   edf k-index p-value
## s(latitude,longitude) 59.00 17.64    1.11       1</code></pre>
<pre class="r"><code>gam.check(gamSE)</code></pre>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 7 iterations.
## Gradient range [-6.972236e-07,-6.972236e-07]
## (score -0.5066816 &amp; scale 1).
## Hessian positive definite, eigenvalue range [6.96943e-07,6.96943e-07].
## Model rank =  126 / 126 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                          k&#39;   edf k-index p-value
## s(latitude,longitude) 59.00  2.00    1.03    0.84</code></pre>
<pre class="r"><code>gam.check(gamEQ)</code></pre>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## step failed after 35 iterations.
## Gradient range [3.18731e-05,3.18731e-05]
## (score -0.7286916 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.001106209,0.001106209].
## Model rank =  126 / 126 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                          k&#39;   edf k-index p-value
## s(latitude,longitude) 59.00 12.76    1.26       1</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-53-1.png" width="672" /><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-53-2.png" width="672" /><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-53-3.png" width="672" /><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-53-4.png" width="672" /><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-53-5.png" width="672" /></p>
</div>
</div>
<div id="results-1" class="section level2">
<h2>Results</h2>
<pre class="r"><code># English
summary(gamE)</code></pre>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## I(LANGUAGE == &quot;English&quot;) ~ s(latitude, longitude, k = 60) + YELP + 
##     COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED + 
##     Topic
## 
## Parametric coefficients:
##                                               Estimate Std. Error z value
## (Intercept)                                  4.990e+01  5.036e+05   0.000
## YELP1                                        2.984e-01  3.220e-01   0.927
## YELP2                                        1.588e+00  4.304e-01   3.688
## YELP3                                        2.082e+00  1.254e+00   1.660
## YELP4                                        2.518e+01  2.451e+05   0.000
## COMMUNICATIVE_ROLEEstablishment_Description -1.026e+00  6.068e-01  -1.690
## COMMUNICATIVE_ROLEEstablishment_Name        -7.267e-01  5.730e-01  -1.268
## COMMUNICATIVE_ROLEGraffiti                   8.023e-01  1.078e+00   0.744
## COMMUNICATIVE_ROLEInformation               -8.694e-01  5.884e-01  -1.478
## COMMUNICATIVE_ROLEInstructions               2.497e+01  1.296e+05   0.000
## COMMUNICATIVE_ROLELeaflet                   -3.804e-01  1.913e+00  -0.199
## COMMUNICATIVE_ROLESlogan                    -1.360e+00  1.391e+00  -0.978
## COMMUNICATIVE_ROLEStreet_Signs               1.046e+00  1.450e+00   0.722
## MATERIALITYHand_Written                      6.629e-01  1.495e+00   0.443
## MATERIALITYHome_Printed                      7.129e-01  1.525e+00   0.468
## MATERIALITYPermanent                         2.042e+00  1.721e+00   1.186
## MATERIALITYProfessionally_Printed            1.567e+00  1.500e+00   1.044
## CONTEXT_FRAMEBakery                         -2.696e+01  3.561e+05   0.000
## CONTEXT_FRAMEBar                            -2.457e+01  3.561e+05   0.000
## CONTEXT_FRAMEBeauty_Hair_Salon              -2.574e+01  3.561e+05   0.000
## CONTEXT_FRAMEBusiness                       -2.529e+01  3.561e+05   0.000
## CONTEXT_FRAMECafe                            1.666e-02  3.606e+05   0.000
## CONTEXT_FRAMEClothing                       -2.576e+01  3.561e+05   0.000
## CONTEXT_FRAMECommentary                     -2.541e+01  3.561e+05   0.000
## CONTEXT_FRAMEExternal                       -2.548e+01  3.561e+05   0.000
## CONTEXT_FRAMEFlier                          -5.344e+01  4.362e+05   0.000
## CONTEXT_FRAMEGallery_Museum                 -2.710e+01  3.561e+05   0.000
## CONTEXT_FRAMEGrocery_Liquor_Store           -2.641e+01  3.561e+05   0.000
## CONTEXT_FRAMEGym_Fitness_Studio              4.657e-01  3.964e+05   0.000
## CONTEXT_FRAMEHardware                       -1.595e+00  4.191e+05   0.000
## CONTEXT_FRAMEHotel                          -2.606e+01  3.561e+05   0.000
## CONTEXT_FRAMEInstitution                    -2.557e+01  3.561e+05   0.000
## CONTEXT_FRAMEJewelry_Store                  -2.339e+01  3.561e+05   0.000
## CONTEXT_FRAMELandromat                      -4.914e-01  4.305e+05   0.000
## CONTEXT_FRAMEMenu                           -5.225e+00  5.036e+05   0.000
## CONTEXT_FRAMEMovie_Theater                  -2.367e+01  3.561e+05   0.000
## CONTEXT_FRAMENightclub                      -4.828e-01  4.089e+05   0.000
## CONTEXT_FRAMENotary_Financial_Services      -2.855e+01  3.561e+05   0.000
## CONTEXT_FRAMEResidential                    -7.777e+01  4.673e+05   0.000
## CONTEXT_FRAMERestaurant                     -2.664e+01  3.561e+05   0.000
## CONTEXT_FRAMEShop                           -2.552e+01  3.561e+05   0.000
## CONTEXT_FRAMESpecialty_Foods                -2.583e+01  3.561e+05   0.000
## CONTEXT_FRAMESupermarket                    -2.544e+01  3.561e+05   0.000
## CONTEXT_FRAMETravel_Agency                  -5.426e+01  3.901e+05   0.000
## CLOSEDFALSE                                 -2.463e+01  3.561e+05   0.000
## CLOSEDTRUE                                  -2.430e+01  3.561e+05   0.000
## Topic2                                      -1.673e-01  5.049e-01  -0.331
## Topic3                                       3.205e-01  6.109e-01   0.525
## Topic4                                       9.554e-01  4.934e-01   1.936
## Topic5                                       3.184e-01  5.598e-01   0.569
## Topic6                                       3.246e-01  7.153e-01   0.454
## Topic7                                       1.838e+00  1.023e+00   1.798
## Topic8                                       1.427e+00  8.291e-01   1.721
## Topic9                                       7.251e-01  5.262e-01   1.378
## Topic10                                      1.284e+00  6.455e-01   1.989
## Topic11                                      3.955e-01  1.101e+00   0.359
## Topic12                                     -9.880e-02  6.304e-01  -0.157
## Topic13                                      2.616e+01  1.375e+05   0.000
## Topic14                                      2.721e+01  1.291e+05   0.000
## Topic15                                     -1.580e+00  1.345e+00  -1.175
## Topic16                                      2.033e+00  9.328e-01   2.179
## Topic17                                      7.820e-01  7.100e-01   1.101
## Topic18                                     -1.331e-01  7.560e-01  -0.176
## Topic19                                     -4.293e-01  6.751e-01  -0.636
## Topic20                                      2.557e+01  1.684e+05   0.000
## Topic21                                     -1.319e+00  9.210e-01  -1.433
## Topic22                                      1.759e+00  1.237e+00   1.421
##                                             Pr(&gt;|z|)    
## (Intercept)                                 0.999921    
## YELP1                                       0.353962    
## YELP2                                       0.000226 ***
## YELP3                                       0.096956 .  
## YELP4                                       0.999918    
## COMMUNICATIVE_ROLEEstablishment_Description 0.091033 .  
## COMMUNICATIVE_ROLEEstablishment_Name        0.204729    
## COMMUNICATIVE_ROLEGraffiti                  0.456689    
## COMMUNICATIVE_ROLEInformation               0.139481    
## COMMUNICATIVE_ROLEInstructions              0.999846    
## COMMUNICATIVE_ROLELeaflet                   0.842426    
## COMMUNICATIVE_ROLESlogan                    0.328013    
## COMMUNICATIVE_ROLEStreet_Signs              0.470596    
## MATERIALITYHand_Written                     0.657435    
## MATERIALITYHome_Printed                     0.640091    
## MATERIALITYPermanent                        0.235460    
## MATERIALITYProfessionally_Printed           0.296401    
## CONTEXT_FRAMEBakery                         0.999940    
## CONTEXT_FRAMEBar                            0.999945    
## CONTEXT_FRAMEBeauty_Hair_Salon              0.999942    
## CONTEXT_FRAMEBusiness                       0.999943    
## CONTEXT_FRAMECafe                           1.000000    
## CONTEXT_FRAMEClothing                       0.999942    
## CONTEXT_FRAMECommentary                     0.999943    
## CONTEXT_FRAMEExternal                       0.999943    
## CONTEXT_FRAMEFlier                          0.999902    
## CONTEXT_FRAMEGallery_Museum                 0.999939    
## CONTEXT_FRAMEGrocery_Liquor_Store           0.999941    
## CONTEXT_FRAMEGym_Fitness_Studio             0.999999    
## CONTEXT_FRAMEHardware                       0.999997    
## CONTEXT_FRAMEHotel                          0.999942    
## CONTEXT_FRAMEInstitution                    0.999943    
## CONTEXT_FRAMEJewelry_Store                  0.999948    
## CONTEXT_FRAMELandromat                      0.999999    
## CONTEXT_FRAMEMenu                           0.999992    
## CONTEXT_FRAMEMovie_Theater                  0.999947    
## CONTEXT_FRAMENightclub                      0.999999    
## CONTEXT_FRAMENotary_Financial_Services      0.999936    
## CONTEXT_FRAMEResidential                    0.999867    
## CONTEXT_FRAMERestaurant                     0.999940    
## CONTEXT_FRAMEShop                           0.999943    
## CONTEXT_FRAMESpecialty_Foods                0.999942    
## CONTEXT_FRAMESupermarket                    0.999943    
## CONTEXT_FRAMETravel_Agency                  0.999889    
## CLOSEDFALSE                                 0.999945    
## CLOSEDTRUE                                  0.999946    
## Topic2                                      0.740359    
## Topic3                                      0.599904    
## Topic4                                      0.052811 .  
## Topic5                                      0.569532    
## Topic6                                      0.649956    
## Topic7                                      0.072237 .  
## Topic8                                      0.085337 .  
## Topic9                                      0.168237    
## Topic10                                     0.046698 *  
## Topic11                                     0.719444    
## Topic12                                     0.875468    
## Topic13                                     0.999848    
## Topic14                                     0.999832    
## Topic15                                     0.240117    
## Topic16                                     0.029330 *  
## Topic17                                     0.270734    
## Topic18                                     0.860228    
## Topic19                                     0.524893    
## Topic20                                     0.999879    
## Topic21                                     0.151954    
## Topic22                                     0.155201    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                         edf Ref.df Chi.sq p-value  
## s(latitude,longitude) 20.11  26.84  41.76  0.0355 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.335   Deviance explained = 38.2%
## UBRE = 0.040535  Scale est. = 1         n = 700</code></pre>
<pre class="r"><code># To get odds ratios (commented out for clarity)
# exp(coef(gamE))

# Spanish
summary(gamS)</code></pre>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## I(LANGUAGE == &quot;Spanish&quot;) ~ s(latitude, longitude, k = 60) + YELP + 
##     COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED + 
##     Topic
## 
## Parametric coefficients:
##                                               Estimate Std. Error z value
## (Intercept)                                 -6.405e+02  9.491e+07   0.000
## YELP1                                       -3.300e-01  5.326e-01  -0.620
## YELP2                                       -2.298e+00  8.522e-01  -2.696
## YELP3                                        5.881e-02  2.561e+00   0.023
## YELP4                                       -4.461e+01  4.745e+07   0.000
## COMMUNICATIVE_ROLEEstablishment_Description  2.528e+00  1.290e+00   1.959
## COMMUNICATIVE_ROLEEstablishment_Name         2.189e+00  1.264e+00   1.732
## COMMUNICATIVE_ROLEGraffiti                  -1.206e+00  1.800e+00  -0.670
## COMMUNICATIVE_ROLEInformation                1.447e+00  1.239e+00   1.168
## COMMUNICATIVE_ROLEInstructions              -2.627e+02  3.032e+07   0.000
## COMMUNICATIVE_ROLELeaflet                    1.924e+00  2.592e+00   0.742
## COMMUNICATIVE_ROLESlogan                     2.383e+00  2.011e+00   1.185
## COMMUNICATIVE_ROLEStreet_Signs              -1.667e+02  1.628e+07   0.000
## MATERIALITYHand_Written                      3.010e+00  3.356e+00   0.897
## MATERIALITYHome_Printed                      2.265e+00  3.597e+00   0.630
## MATERIALITYPermanent                        -1.213e+00  3.832e+00  -0.317
## MATERIALITYProfessionally_Printed            6.240e-02  3.447e+00   0.018
## CONTEXT_FRAMEBakery                          3.139e+02  6.711e+07   0.000
## CONTEXT_FRAMEBar                             2.685e+02  6.946e+07   0.000
## CONTEXT_FRAMEBeauty_Hair_Salon               3.114e+02  6.711e+07   0.000
## CONTEXT_FRAMEBusiness                        3.129e+02  6.711e+07   0.000
## CONTEXT_FRAMECafe                            2.752e+02  6.838e+07   0.000
## CONTEXT_FRAMEClothing                        3.139e+02  6.711e+07   0.000
## CONTEXT_FRAMECommentary                      3.167e+02  6.711e+07   0.000
## CONTEXT_FRAMEExternal                        3.146e+02  6.711e+07   0.000
## CONTEXT_FRAMEFlier                           3.613e+02  8.219e+07   0.000
## CONTEXT_FRAMEGallery_Museum                  3.003e+02  6.711e+07   0.000
## CONTEXT_FRAMEGrocery_Liquor_Store            3.121e+02  6.711e+07   0.000
## CONTEXT_FRAMEGym_Fitness_Studio              2.746e+02  7.503e+07   0.000
## CONTEXT_FRAMEHardware                        2.675e+02  8.219e+07   0.000
## CONTEXT_FRAMEHotel                           2.680e+02  7.249e+07   0.000
## CONTEXT_FRAMEInstitution                     3.120e+02  6.711e+07   0.000
## CONTEXT_FRAMEJewelry_Store                   3.081e+02  6.711e+07   0.000
## CONTEXT_FRAMELandromat                       7.204e+01  8.268e+07   0.000
## CONTEXT_FRAMEMenu                            6.990e+03  9.491e+07   0.000
## CONTEXT_FRAMEMovie_Theater                   3.129e+02  6.711e+07   0.000
## CONTEXT_FRAMENightclub                       2.521e+02  7.749e+07   0.000
## CONTEXT_FRAMENotary_Financial_Services       3.141e+02  6.711e+07   0.000
## CONTEXT_FRAMEResidential                     4.009e+02  8.878e+07   0.000
## CONTEXT_FRAMERestaurant                      3.149e+02  6.711e+07   0.000
## CONTEXT_FRAMEShop                            3.119e+02  6.711e+07   0.000
## CONTEXT_FRAMESpecialty_Foods                 3.495e+02  7.045e+07   0.000
## CONTEXT_FRAMESupermarket                     3.127e+02  6.711e+07   0.000
## CONTEXT_FRAMETravel_Agency                   3.212e+02  6.711e+07   0.000
## CLOSEDFALSE                                  5.548e+01  6.711e+07   0.000
## CLOSEDTRUE                                   5.434e+01  6.711e+07   0.000
## Topic2                                      -1.388e+00  1.392e+00  -0.997
## Topic3                                      -1.043e+00  1.299e+00  -0.803
## Topic4                                       3.978e-01  1.390e+00   0.286
## Topic5                                      -3.210e+00  1.909e+00  -1.682
## Topic6                                      -1.250e+00  1.590e+00  -0.786
## Topic7                                      -7.038e-01  3.401e+00  -0.207
## Topic8                                      -6.842e+00  2.277e+00  -3.005
## Topic9                                      -3.714e+00  1.972e+00  -1.883
## Topic10                                     -2.015e+00  1.988e+00  -1.014
## Topic11                                      1.331e+00  2.402e+00   0.554
## Topic12                                      3.456e-01  1.050e+00   0.329
## Topic13                                     -4.195e+01  3.047e+07   0.000
## Topic14                                     -4.890e+01  3.001e+07   0.000
## Topic15                                     -4.179e+00  2.514e+00  -1.662
## Topic16                                     -7.043e+00  2.499e+00  -2.818
## Topic17                                     -7.767e+00  2.821e+00  -2.753
## Topic18                                     -3.160e+00  2.059e+00  -1.534
## Topic19                                     -1.841e+00  2.599e+00  -0.708
## Topic20                                     -5.276e+01  3.355e+07   0.000
## Topic21                                     -2.558e-01  2.339e+00  -0.109
## Topic22                                     -4.039e+01  1.799e+07   0.000
##                                             Pr(&gt;|z|)   
## (Intercept)                                  0.99999   
## YELP1                                        0.53552   
## YELP2                                        0.00702 **
## YELP3                                        0.98168   
## YELP4                                        1.00000   
## COMMUNICATIVE_ROLEEstablishment_Description  0.05014 . 
## COMMUNICATIVE_ROLEEstablishment_Name         0.08326 . 
## COMMUNICATIVE_ROLEGraffiti                   0.50272   
## COMMUNICATIVE_ROLEInformation                0.24273   
## COMMUNICATIVE_ROLEInstructions               0.99999   
## COMMUNICATIVE_ROLELeaflet                    0.45787   
## COMMUNICATIVE_ROLESlogan                     0.23612   
## COMMUNICATIVE_ROLEStreet_Signs               0.99999   
## MATERIALITYHand_Written                      0.36988   
## MATERIALITYHome_Printed                      0.52884   
## MATERIALITYPermanent                         0.75151   
## MATERIALITYProfessionally_Printed            0.98556   
## CONTEXT_FRAMEBakery                          1.00000   
## CONTEXT_FRAMEBar                             1.00000   
## CONTEXT_FRAMEBeauty_Hair_Salon               1.00000   
## CONTEXT_FRAMEBusiness                        1.00000   
## CONTEXT_FRAMECafe                            1.00000   
## CONTEXT_FRAMEClothing                        1.00000   
## CONTEXT_FRAMECommentary                      1.00000   
## CONTEXT_FRAMEExternal                        1.00000   
## CONTEXT_FRAMEFlier                           1.00000   
## CONTEXT_FRAMEGallery_Museum                  1.00000   
## CONTEXT_FRAMEGrocery_Liquor_Store            1.00000   
## CONTEXT_FRAMEGym_Fitness_Studio              1.00000   
## CONTEXT_FRAMEHardware                        1.00000   
## CONTEXT_FRAMEHotel                           1.00000   
## CONTEXT_FRAMEInstitution                     1.00000   
## CONTEXT_FRAMEJewelry_Store                   1.00000   
## CONTEXT_FRAMELandromat                       1.00000   
## CONTEXT_FRAMEMenu                            0.99994   
## CONTEXT_FRAMEMovie_Theater                   1.00000   
## CONTEXT_FRAMENightclub                       1.00000   
## CONTEXT_FRAMENotary_Financial_Services       1.00000   
## CONTEXT_FRAMEResidential                     1.00000   
## CONTEXT_FRAMERestaurant                      1.00000   
## CONTEXT_FRAMEShop                            1.00000   
## CONTEXT_FRAMESpecialty_Foods                 1.00000   
## CONTEXT_FRAMESupermarket                     1.00000   
## CONTEXT_FRAMETravel_Agency                   1.00000   
## CLOSEDFALSE                                  1.00000   
## CLOSEDTRUE                                   1.00000   
## Topic2                                       0.31881   
## Topic3                                       0.42176   
## Topic4                                       0.77471   
## Topic5                                       0.09262 . 
## Topic6                                       0.43168   
## Topic7                                       0.83605   
## Topic8                                       0.00266 **
## Topic9                                       0.05965 . 
## Topic10                                      0.31071   
## Topic11                                      0.57937   
## Topic12                                      0.74211   
## Topic13                                      1.00000   
## Topic14                                      1.00000   
## Topic15                                      0.09648 . 
## Topic16                                      0.00483 **
## Topic17                                      0.00591 **
## Topic18                                      0.12492   
## Topic19                                      0.47879   
## Topic20                                      1.00000   
## Topic21                                      0.91292   
## Topic22                                      1.00000   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                         edf Ref.df Chi.sq p-value
## s(latitude,longitude) 57.96  58.61  64.08   0.294
## 
## R-sq.(adj) =  0.438   Deviance explained = 53.4%
## UBRE = -0.173  Scale est. = 1         n = 700</code></pre>
<pre class="r"><code># Odds ratios
# exp(coef(gamES))

# Mostly English with Some Spanish
# Spanish
summary(gamES)</code></pre>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## I(LANGUAGE == &quot;Eng_Span&quot;) ~ s(latitude, longitude, k = 60) + 
##     YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + 
##     CLOSED + Topic
## 
## Parametric coefficients:
##                                               Estimate Std. Error z value
## (Intercept)                                 -9.157e+01  6.723e+07   0.000
## YELP1                                        1.712e+00  1.024e+00   1.672
## YELP2                                       -3.042e-01  1.165e+00  -0.261
## YELP3                                       -3.202e+01  1.331e+07   0.000
## YELP4                                        9.460e-01  5.054e+07   0.000
## COMMUNICATIVE_ROLEEstablishment_Description -2.680e-02  1.475e+00  -0.018
## COMMUNICATIVE_ROLEEstablishment_Name         2.765e-02  1.424e+00   0.019
## COMMUNICATIVE_ROLEGraffiti                   3.348e+01  8.920e+06   0.000
## COMMUNICATIVE_ROLEInformation               -9.775e-01  1.595e+00  -0.613
## COMMUNICATIVE_ROLEInstructions              -2.237e+00  3.135e+07   0.000
## COMMUNICATIVE_ROLELeaflet                    1.298e+01  1.978e+07   0.000
## COMMUNICATIVE_ROLESlogan                     2.938e+00  2.178e+00   1.349
## COMMUNICATIVE_ROLEStreet_Signs              -4.105e+00  1.867e+07   0.000
## MATERIALITYHand_Written                      2.620e+01  2.552e+06   0.000
## MATERIALITYHome_Printed                      2.584e+01  2.552e+06   0.000
## MATERIALITYPermanent                         2.910e+01  2.552e+06   0.000
## MATERIALITYProfessionally_Printed            2.669e+01  2.552e+06   0.000
## CONTEXT_FRAMEBakery                          2.951e+01  6.994e+07   0.000
## CONTEXT_FRAMEBar                             3.607e+01  6.949e+07   0.000
## CONTEXT_FRAMEBeauty_Hair_Salon               6.884e+01  6.711e+07   0.000
## CONTEXT_FRAMEBusiness                        6.671e+01  6.711e+07   0.000
## CONTEXT_FRAMECafe                            3.592e+01  6.835e+07   0.000
## CONTEXT_FRAMEClothing                        3.707e+01  6.932e+07   0.000
## CONTEXT_FRAMECommentary                      5.441e+00  7.104e+07   0.000
## CONTEXT_FRAMEExternal                        3.740e+01  6.770e+07   0.000
## CONTEXT_FRAMEFlier                           2.216e+01  8.454e+07   0.000
## CONTEXT_FRAMEGallery_Museum                  7.062e+01  6.711e+07   0.000
## CONTEXT_FRAMEGrocery_Liquor_Store            6.907e+01  6.711e+07   0.000
## CONTEXT_FRAMEGym_Fitness_Studio              3.604e+01  7.503e+07   0.000
## CONTEXT_FRAMEHardware                        3.687e+01  8.219e+07   0.000
## CONTEXT_FRAMEHotel                           7.043e+01  6.711e+07   0.000
## CONTEXT_FRAMEInstitution                     3.782e+01  7.127e+07   0.000
## CONTEXT_FRAMEJewelry_Store                   3.541e+01  7.045e+07   0.000
## CONTEXT_FRAMELandromat                       4.067e+01  8.232e+07   0.000
## CONTEXT_FRAMEMenu                            4.285e+01  9.491e+07   0.000
## CONTEXT_FRAMEMovie_Theater                   3.530e+01  7.187e+07   0.000
## CONTEXT_FRAMENightclub                       3.814e+01  7.786e+07   0.000
## CONTEXT_FRAMENotary_Financial_Services       3.813e+01  7.351e+07   0.000
## CONTEXT_FRAMEResidential                     6.612e+01  8.893e+07   0.000
## CONTEXT_FRAMERestaurant                      6.800e+01  6.711e+07   0.000
## CONTEXT_FRAMEShop                            6.791e+01  6.711e+07   0.000
## CONTEXT_FRAMESpecialty_Foods                 3.632e+01  7.062e+07   0.000
## CONTEXT_FRAMESupermarket                     6.970e+01  6.711e+07   0.000
## CONTEXT_FRAMETravel_Agency                   3.740e+01  7.351e+07   0.000
## CLOSEDFALSE                                 -7.310e+00  3.126e+06   0.000
## CLOSEDTRUE                                  -7.519e+00  3.126e+06   0.000
## Topic2                                       2.534e-01  1.140e+00   0.222
## Topic3                                      -5.211e-01  1.581e+00  -0.330
## Topic4                                      -2.192e+00  1.360e+00  -1.611
## Topic5                                      -3.224e+01  1.140e+07   0.000
## Topic6                                       9.174e-01  1.343e+00   0.683
## Topic7                                       1.400e+00  1.672e+00   0.838
## Topic8                                      -3.084e+01  3.122e+06   0.000
## Topic9                                       8.210e-01  1.016e+00   0.808
## Topic10                                     -1.965e+00  1.470e+00  -1.336
## Topic11                                     -3.118e+01  2.340e+07   0.000
## Topic12                                     -3.255e+01  1.469e+07   0.000
## Topic13                                     -3.089e+01  3.046e+07   0.000
## Topic14                                     -2.990e+01  3.006e+07   0.000
## Topic15                                      6.170e+00  1.775e+00   3.476
## Topic16                                     -5.035e-01  1.513e+00  -0.333
## Topic17                                     -3.304e+01  1.684e+07   0.000
## Topic18                                      1.425e-01  2.359e+00   0.060
## Topic19                                     -3.344e-01  1.301e+00  -0.257
## Topic20                                     -3.063e+01  3.395e+07   0.000
## Topic21                                     -3.061e+01  1.837e+07   0.000
## Topic22                                     -5.892e+01  9.203e+06   0.000
##                                             Pr(&gt;|z|)    
## (Intercept)                                 0.999999    
## YELP1                                       0.094554 .  
## YELP2                                       0.793932    
## YELP3                                       0.999998    
## YELP4                                       1.000000    
## COMMUNICATIVE_ROLEEstablishment_Description 0.985504    
## COMMUNICATIVE_ROLEEstablishment_Name        0.984507    
## COMMUNICATIVE_ROLEGraffiti                  0.999997    
## COMMUNICATIVE_ROLEInformation               0.539858    
## COMMUNICATIVE_ROLEInstructions              1.000000    
## COMMUNICATIVE_ROLELeaflet                   0.999999    
## COMMUNICATIVE_ROLESlogan                    0.177245    
## COMMUNICATIVE_ROLEStreet_Signs              1.000000    
## MATERIALITYHand_Written                     0.999992    
## MATERIALITYHome_Printed                     0.999992    
## MATERIALITYPermanent                        0.999991    
## MATERIALITYProfessionally_Printed           0.999992    
## CONTEXT_FRAMEBakery                         1.000000    
## CONTEXT_FRAMEBar                            1.000000    
## CONTEXT_FRAMEBeauty_Hair_Salon              0.999999    
## CONTEXT_FRAMEBusiness                       0.999999    
## CONTEXT_FRAMECafe                           1.000000    
## CONTEXT_FRAMEClothing                       1.000000    
## CONTEXT_FRAMECommentary                     1.000000    
## CONTEXT_FRAMEExternal                       1.000000    
## CONTEXT_FRAMEFlier                          1.000000    
## CONTEXT_FRAMEGallery_Museum                 0.999999    
## CONTEXT_FRAMEGrocery_Liquor_Store           0.999999    
## CONTEXT_FRAMEGym_Fitness_Studio             1.000000    
## CONTEXT_FRAMEHardware                       1.000000    
## CONTEXT_FRAMEHotel                          0.999999    
## CONTEXT_FRAMEInstitution                    1.000000    
## CONTEXT_FRAMEJewelry_Store                  1.000000    
## CONTEXT_FRAMELandromat                      1.000000    
## CONTEXT_FRAMEMenu                           1.000000    
## CONTEXT_FRAMEMovie_Theater                  1.000000    
## CONTEXT_FRAMENightclub                      1.000000    
## CONTEXT_FRAMENotary_Financial_Services      1.000000    
## CONTEXT_FRAMEResidential                    0.999999    
## CONTEXT_FRAMERestaurant                     0.999999    
## CONTEXT_FRAMEShop                           0.999999    
## CONTEXT_FRAMESpecialty_Foods                1.000000    
## CONTEXT_FRAMESupermarket                    0.999999    
## CONTEXT_FRAMETravel_Agency                  1.000000    
## CLOSEDFALSE                                 0.999998    
## CLOSEDTRUE                                  0.999998    
## Topic2                                      0.824161    
## Topic3                                      0.741752    
## Topic4                                      0.107155    
## Topic5                                      0.999998    
## Topic6                                      0.494642    
## Topic7                                      0.402244    
## Topic8                                      0.999992    
## Topic9                                      0.418832    
## Topic10                                     0.181480    
## Topic11                                     0.999999    
## Topic12                                     0.999998    
## Topic13                                     0.999999    
## Topic14                                     0.999999    
## Topic15                                     0.000509 ***
## Topic16                                     0.739367    
## Topic17                                     0.999998    
## Topic18                                     0.951830    
## Topic19                                     0.797135    
## Topic20                                     0.999999    
## Topic21                                     0.999999    
## Topic22                                     0.999995    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                         edf Ref.df Chi.sq p-value
## s(latitude,longitude) 17.64  23.38  23.22   0.467
## 
## R-sq.(adj) =  0.256   Deviance explained = 47.1%
## UBRE = -0.56172  Scale est. = 1         n = 700</code></pre>
<pre class="r"><code># Odds ratios
# exp(coef(gamES))

# Mostly Spanish with some English
summary(gamSE)</code></pre>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## I(LANGUAGE == &quot;Span_Eng&quot;) ~ s(latitude, longitude, k = 60) + 
##     YELP + COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + 
##     CLOSED + Topic
## 
## Parametric coefficients:
##                                               Estimate Std. Error z value
## (Intercept)                                 -8.388e+06  6.712e+07  -0.125
## YELP1                                       -5.546e-01  5.436e-01  -1.020
## YELP2                                       -1.772e+00  9.086e-01  -1.950
## YELP3                                       -2.471e+01  1.482e+05   0.000
## YELP4                                       -2.476e+01  7.382e+05   0.000
## COMMUNICATIVE_ROLEEstablishment_Description  6.912e-01  1.237e+00   0.559
## COMMUNICATIVE_ROLEEstablishment_Name         2.719e-02  1.204e+00   0.023
## COMMUNICATIVE_ROLEGraffiti                  -2.871e-02  3.738e+05   0.000
## COMMUNICATIVE_ROLEInformation                9.792e-01  1.248e+00   0.785
## COMMUNICATIVE_ROLEInstructions              -1.003e-01  3.930e+05   0.000
## COMMUNICATIVE_ROLELeaflet                   -2.249e+01  3.507e+05   0.000
## COMMUNICATIVE_ROLESlogan                     1.047e+00  4.646e+05   0.000
## COMMUNICATIVE_ROLEStreet_Signs               2.317e+01  2.708e+05   0.000
## MATERIALITYHand_Written                     -2.686e+00  3.420e+05   0.000
## MATERIALITYHome_Printed                     -1.065e+00  3.420e+05   0.000
## MATERIALITYPermanent                        -2.458e+01  3.602e+05   0.000
## MATERIALITYProfessionally_Printed           -8.574e-01  3.420e+05   0.000
## CONTEXT_FRAMEBakery                          8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEBar                             8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEBeauty_Hair_Salon               8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEBusiness                        8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMECafe                            8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEClothing                        8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMECommentary                      8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEExternal                        8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEFlier                           8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEGallery_Museum                  8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEGrocery_Liquor_Store            8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEGym_Fitness_Studio              8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEHardware                        8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEHotel                           8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEInstitution                     8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEJewelry_Store                   8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMELandromat                       8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEMenu                            8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEMovie_Theater                   8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMENightclub                       8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMENotary_Financial_Services       8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEResidential                     8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMERestaurant                      8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMEShop                            8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMESpecialty_Foods                 8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMESupermarket                     8.388e+06  6.711e+07   0.125
## CONTEXT_FRAMETravel_Agency                   8.388e+06  6.711e+07   0.125
## CLOSEDFALSE                                  1.256e+00  1.179e+06   0.000
## CLOSEDTRUE                                   1.712e+00  1.179e+06   0.000
## Topic2                                       2.975e-01  7.916e-01   0.376
## Topic3                                      -9.652e-01  1.170e+00  -0.825
## Topic4                                      -1.114e+00  8.622e-01  -1.292
## Topic5                                       1.321e+00  6.948e-01   1.902
## Topic6                                      -5.116e+01  1.801e+05   0.000
## Topic7                                      -2.609e+01  2.034e+05   0.000
## Topic8                                      -2.550e+01  2.359e+05   0.000
## Topic9                                      -2.607e+01  1.266e+05   0.000
## Topic10                                     -1.364e+00  1.061e+00  -1.285
## Topic11                                     -2.577e+01  2.807e+05   0.000
## Topic12                                      1.118e-01  9.142e-01   0.122
## Topic13                                     -2.633e+01  4.527e+05   0.000
## Topic14                                     -2.553e+01  4.402e+05   0.000
## Topic15                                     -2.618e+01  4.851e+05   0.000
## Topic16                                     -2.533e+01  1.231e+05   0.000
## Topic17                                     -2.112e-01  1.219e+00  -0.173
## Topic18                                     -2.023e+00  1.422e+00  -1.423
## Topic19                                     -6.111e-01  9.939e-01  -0.615
## Topic20                                     -2.548e+01  4.378e+05   0.000
## Topic21                                      1.126e+00  1.005e+00   1.120
## Topic22                                     -2.517e+01  2.460e+05   0.000
##                                             Pr(&gt;|z|)  
## (Intercept)                                   0.9005  
## YELP1                                         0.3076  
## YELP2                                         0.0512 .
## YELP3                                         0.9999  
## YELP4                                         1.0000  
## COMMUNICATIVE_ROLEEstablishment_Description   0.5763  
## COMMUNICATIVE_ROLEEstablishment_Name          0.9820  
## COMMUNICATIVE_ROLEGraffiti                    1.0000  
## COMMUNICATIVE_ROLEInformation                 0.4326  
## COMMUNICATIVE_ROLEInstructions                1.0000  
## COMMUNICATIVE_ROLELeaflet                     0.9999  
## COMMUNICATIVE_ROLESlogan                      1.0000  
## COMMUNICATIVE_ROLEStreet_Signs                0.9999  
## MATERIALITYHand_Written                       1.0000  
## MATERIALITYHome_Printed                       1.0000  
## MATERIALITYPermanent                          0.9999  
## MATERIALITYProfessionally_Printed             1.0000  
## CONTEXT_FRAMEBakery                           0.9005  
## CONTEXT_FRAMEBar                              0.9005  
## CONTEXT_FRAMEBeauty_Hair_Salon                0.9005  
## CONTEXT_FRAMEBusiness                         0.9005  
## CONTEXT_FRAMECafe                             0.9005  
## CONTEXT_FRAMEClothing                         0.9005  
## CONTEXT_FRAMECommentary                       0.9005  
## CONTEXT_FRAMEExternal                         0.9005  
## CONTEXT_FRAMEFlier                            0.9005  
## CONTEXT_FRAMEGallery_Museum                   0.9005  
## CONTEXT_FRAMEGrocery_Liquor_Store             0.9005  
## CONTEXT_FRAMEGym_Fitness_Studio               0.9005  
## CONTEXT_FRAMEHardware                         0.9005  
## CONTEXT_FRAMEHotel                            0.9005  
## CONTEXT_FRAMEInstitution                      0.9005  
## CONTEXT_FRAMEJewelry_Store                    0.9005  
## CONTEXT_FRAMELandromat                        0.9005  
## CONTEXT_FRAMEMenu                             0.9005  
## CONTEXT_FRAMEMovie_Theater                    0.9005  
## CONTEXT_FRAMENightclub                        0.9005  
## CONTEXT_FRAMENotary_Financial_Services        0.9005  
## CONTEXT_FRAMEResidential                      0.9005  
## CONTEXT_FRAMERestaurant                       0.9005  
## CONTEXT_FRAMEShop                             0.9005  
## CONTEXT_FRAMESpecialty_Foods                  0.9005  
## CONTEXT_FRAMESupermarket                      0.9005  
## CONTEXT_FRAMETravel_Agency                    0.9005  
## CLOSEDFALSE                                   1.0000  
## CLOSEDTRUE                                    1.0000  
## Topic2                                        0.7070  
## Topic3                                        0.4094  
## Topic4                                        0.1962  
## Topic5                                        0.0572 .
## Topic6                                        0.9998  
## Topic7                                        0.9999  
## Topic8                                        0.9999  
## Topic9                                        0.9998  
## Topic10                                       0.1986  
## Topic11                                       0.9999  
## Topic12                                       0.9026  
## Topic13                                       1.0000  
## Topic14                                       1.0000  
## Topic15                                       1.0000  
## Topic16                                       0.9998  
## Topic17                                       0.8625  
## Topic18                                       0.1548  
## Topic19                                       0.5387  
## Topic20                                       1.0000  
## Topic21                                       0.2626  
## Topic22                                       0.9999  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                         edf Ref.df Chi.sq p-value  
## s(latitude,longitude) 2.001  2.001  5.263  0.0721 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.074   Deviance explained = 31.1%
## UBRE = -0.50668  Scale est. = 1         n = 700</code></pre>
<pre class="r"><code># Odds ratios
# exp(coef(gamSE))

# Equal
summary(gamEQ)</code></pre>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## I(LANGUAGE == &quot;Equal&quot;) ~ s(latitude, longitude, k = 60) + YELP + 
##     COMMUNICATIVE_ROLE + MATERIALITY + CONTEXT_FRAME + CLOSED + 
##     Topic
## 
## Parametric coefficients:
##                                               Estimate Std. Error z value
## (Intercept)                                  2.852e+02  1.036e+08   0.000
## YELP1                                       -2.500e+01  1.868e+03  -0.013
## YELP2                                       -2.659e+01  3.278e+03  -0.008
## YELP3                                       -1.986e+03  1.424e+07   0.000
## YELP4                                        3.948e+02  5.071e+07   0.000
## COMMUNICATIVE_ROLEEstablishment_Description  2.430e+01  2.547e+05   0.000
## COMMUNICATIVE_ROLEEstablishment_Name         2.329e+01  2.547e+05   0.000
## COMMUNICATIVE_ROLEGraffiti                  -1.301e+02  2.252e+07   0.000
## COMMUNICATIVE_ROLEInformation                2.568e+01  2.547e+05   0.000
## COMMUNICATIVE_ROLEInstructions              -1.092e+03  3.071e+07   0.000
## COMMUNICATIVE_ROLELeaflet                   -2.776e+02  4.703e+07   0.000
## COMMUNICATIVE_ROLESlogan                    -1.116e+01  3.092e+07   0.000
## COMMUNICATIVE_ROLEStreet_Signs               4.654e+01  1.937e+07   0.000
## MATERIALITYHand_Written                     -8.454e+01  4.152e+07   0.000
## MATERIALITYHome_Printed                     -8.813e+01  4.152e+07   0.000
## MATERIALITYPermanent                        -3.476e+02  4.277e+07   0.000
## MATERIALITYProfessionally_Printed           -2.691e+02  4.152e+07   0.000
## CONTEXT_FRAMEBakery                         -6.589e+02  6.794e+07   0.000
## CONTEXT_FRAMEBar                            -4.177e+02  6.957e+07   0.000
## CONTEXT_FRAMEBeauty_Hair_Salon              -4.185e+02  6.851e+07   0.000
## CONTEXT_FRAMEBusiness                       -2.529e+02  6.711e+07   0.000
## CONTEXT_FRAMECafe                           -4.759e+02  6.842e+07   0.000
## CONTEXT_FRAMEClothing                       -4.444e+02  6.929e+07   0.000
## CONTEXT_FRAMECommentary                     -4.744e+02  7.478e+07   0.000
## CONTEXT_FRAMEExternal                       -2.628e+02  6.711e+07   0.000
## CONTEXT_FRAMEFlier                           3.668e+02  9.538e+07   0.000
## CONTEXT_FRAMEGallery_Museum                  7.260e+02  6.711e+07   0.000
## CONTEXT_FRAMEGrocery_Liquor_Store           -5.364e+02  6.794e+07   0.000
## CONTEXT_FRAMEGym_Fitness_Studio             -3.441e+02  7.543e+07   0.000
## CONTEXT_FRAMEHardware                       -2.966e+02  8.248e+07   0.000
## CONTEXT_FRAMEHotel                          -2.207e+02  6.711e+07   0.000
## CONTEXT_FRAMEInstitution                    -4.852e+02  7.126e+07   0.000
## CONTEXT_FRAMEJewelry_Store                  -5.329e+02  7.048e+07   0.000
## CONTEXT_FRAMELandromat                      -5.956e+02  8.219e+07   0.000
## CONTEXT_FRAMEMenu                            1.656e+03  9.553e+07   0.000
## CONTEXT_FRAMEMovie_Theater                  -3.023e+02  7.194e+07   0.000
## CONTEXT_FRAMENightclub                       8.276e+02  7.817e+07   0.000
## CONTEXT_FRAMENotary_Financial_Services      -2.366e+02  7.449e+07   0.000
## CONTEXT_FRAMEResidential                    -2.834e+02  8.922e+07   0.000
## CONTEXT_FRAMERestaurant                     -5.356e+02  6.740e+07   0.000
## CONTEXT_FRAMEShop                           -2.492e+02  6.711e+07   0.000
## CONTEXT_FRAMESpecialty_Foods                -2.741e+02  7.066e+07   0.000
## CONTEXT_FRAMESupermarket                    -4.127e+02  6.711e+07   0.000
## CONTEXT_FRAMETravel_Agency                   3.185e+02  7.351e+07   0.000
## CLOSEDFALSE                                 -2.562e+02  6.711e+07   0.000
## CLOSEDTRUE                                  -1.812e+02  6.895e+07   0.000
## Topic2                                       1.122e+02  5.694e+03   0.020
## Topic3                                      -7.341e+01  1.513e+04  -0.005
## Topic4                                       2.010e+01  1.017e+04   0.002
## Topic5                                      -9.792e+01  1.166e+07   0.000
## Topic6                                      -1.909e+02  1.354e+07   0.000
## Topic7                                      -2.990e+02  1.544e+07   0.000
## Topic8                                      -4.571e+01  1.567e+04  -0.003
## Topic9                                      -3.349e+02  9.304e+06   0.000
## Topic10                                     -2.491e+02  1.086e+07   0.000
## Topic11                                      3.518e+02  3.937e+04   0.009
## Topic12                                     -1.031e+02  1.503e+07   0.000
## Topic13                                      1.268e+02  3.076e+07   0.000
## Topic14                                     -4.679e+02  3.017e+07   0.000
## Topic15                                      1.865e+02  3.031e+07   0.000
## Topic16                                     -1.588e+02  1.731e+07   0.000
## Topic17                                      2.371e+02  1.731e+07   0.000
## Topic18                                      2.497e+02  1.060e+07   0.000
## Topic19                                     -1.098e+00  1.019e+04   0.000
## Topic20                                      2.688e+02  3.471e+07   0.000
## Topic21                                      1.669e+02  3.945e+04   0.004
## Topic22                                      3.523e+02  9.783e+03   0.036
##                                             Pr(&gt;|z|)
## (Intercept)                                    1.000
## YELP1                                          0.989
## YELP2                                          0.994
## YELP3                                          1.000
## YELP4                                          1.000
## COMMUNICATIVE_ROLEEstablishment_Description    1.000
## COMMUNICATIVE_ROLEEstablishment_Name           1.000
## COMMUNICATIVE_ROLEGraffiti                     1.000
## COMMUNICATIVE_ROLEInformation                  1.000
## COMMUNICATIVE_ROLEInstructions                 1.000
## COMMUNICATIVE_ROLELeaflet                      1.000
## COMMUNICATIVE_ROLESlogan                       1.000
## COMMUNICATIVE_ROLEStreet_Signs                 1.000
## MATERIALITYHand_Written                        1.000
## MATERIALITYHome_Printed                        1.000
## MATERIALITYPermanent                           1.000
## MATERIALITYProfessionally_Printed              1.000
## CONTEXT_FRAMEBakery                            1.000
## CONTEXT_FRAMEBar                               1.000
## CONTEXT_FRAMEBeauty_Hair_Salon                 1.000
## CONTEXT_FRAMEBusiness                          1.000
## CONTEXT_FRAMECafe                              1.000
## CONTEXT_FRAMEClothing                          1.000
## CONTEXT_FRAMECommentary                        1.000
## CONTEXT_FRAMEExternal                          1.000
## CONTEXT_FRAMEFlier                             1.000
## CONTEXT_FRAMEGallery_Museum                    1.000
## CONTEXT_FRAMEGrocery_Liquor_Store              1.000
## CONTEXT_FRAMEGym_Fitness_Studio                1.000
## CONTEXT_FRAMEHardware                          1.000
## CONTEXT_FRAMEHotel                             1.000
## CONTEXT_FRAMEInstitution                       1.000
## CONTEXT_FRAMEJewelry_Store                     1.000
## CONTEXT_FRAMELandromat                         1.000
## CONTEXT_FRAMEMenu                              1.000
## CONTEXT_FRAMEMovie_Theater                     1.000
## CONTEXT_FRAMENightclub                         1.000
## CONTEXT_FRAMENotary_Financial_Services         1.000
## CONTEXT_FRAMEResidential                       1.000
## CONTEXT_FRAMERestaurant                        1.000
## CONTEXT_FRAMEShop                              1.000
## CONTEXT_FRAMESpecialty_Foods                   1.000
## CONTEXT_FRAMESupermarket                       1.000
## CONTEXT_FRAMETravel_Agency                     1.000
## CLOSEDFALSE                                    1.000
## CLOSEDTRUE                                     1.000
## Topic2                                         0.984
## Topic3                                         0.996
## Topic4                                         0.998
## Topic5                                         1.000
## Topic6                                         1.000
## Topic7                                         1.000
## Topic8                                         0.998
## Topic9                                         1.000
## Topic10                                        1.000
## Topic11                                        0.993
## Topic12                                        1.000
## Topic13                                        1.000
## Topic14                                        1.000
## Topic15                                        1.000
## Topic16                                        1.000
## Topic17                                        1.000
## Topic18                                        1.000
## Topic19                                        1.000
## Topic20                                        1.000
## Topic21                                        0.997
## Topic22                                        0.971
## 
## Approximate significance of smooth terms:
##                         edf Ref.df Chi.sq p-value
## s(latitude,longitude) 12.76  13.06  0.002       1
## 
## R-sq.(adj) =  0.698   Deviance explained = 83.3%
## UBRE = -0.72869  Scale est. = 1         n = 700</code></pre>
<pre class="r"><code># Odds ratios
# exp(coef(gamEQ))</code></pre>
<p>We can see from these results a lot of information – what is significant, deviance explained, coefficients, etc. But it is also useful to plot probabilities.</p>
<pre class="r"><code># Plot probabilities? (Adapted from http://myweb.uiowa.edu/pbreheny/publications/visreg.pdf)
library(visreg)
# We will just look at those flagged as &#39;significant&#39;
# Probability of English by coordinate
visreg2d(gamE, &quot;longitude&quot;, &quot;latitude&quot;, plot.type=&quot;image&quot;)</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<pre class="r"><code># Spanish
visreg2d(gamS, &quot;longitude&quot;, &quot;latitude&quot;, plot.type=&quot;image&quot;)</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-55-2.png" width="672" /></p>
</div>
<div id="gams-for-instagram-only" class="section level2">
<h2>GAMs for Instagram only</h2>
<p>Let’s look at GAMs within our social media data set.</p>
<pre class="r"><code>emogam &lt;- gam(I(emogrepl==&quot;TRUE&quot;)~s(latitude,longitude, k=60) + V1.x, family=binomial,data=tweets)
concurvity(emogam)</code></pre>
<pre><code>##               para s(latitude,longitude)
## worst    0.9168534            0.09941700
## observed 0.9168534            0.02028529
## estimate 0.9168534            0.01043618</code></pre>
<pre class="r"><code># Concurvity seems ok
gam.check(emogam)</code></pre>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 3 iterations.
## Gradient range [5.004738e-08,5.004738e-08]
## (score -0.008444863 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.0001851222,0.0001851222].
## Model rank =  81 / 81 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                           k&#39;    edf k-index p-value
## s(latitude,longitude) 59.000 36.914   0.915       0</code></pre>
<pre class="r"><code># Same issue with gam.check but will keep k on the lower side to avoid over fitting

# Results!
summary(emogam)</code></pre>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## I(emogrepl == &quot;TRUE&quot;) ~ s(latitude, longitude, k = 60) + V1.x
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.51773    0.06987 -21.723  &lt; 2e-16 ***
## V1.x2       -0.10551    0.10678  -0.988 0.323073    
## V1.x3        0.07772    0.10716   0.725 0.468282    
## V1.x4        0.01201    0.11055   0.109 0.913452    
## V1.x5        0.00548    0.11107   0.049 0.960649    
## V1.x6        0.18434    0.11212   1.644 0.100142    
## V1.x7        0.38492    0.11253   3.421 0.000625 ***
## V1.x8        0.11688    0.11947   0.978 0.327903    
## V1.x9       -0.01001    0.09944  -0.101 0.919822    
## V1.x10       0.24011    0.11187   2.146 0.031849 *  
## V1.x11       0.20051    0.12685   1.581 0.113942    
## V1.x12       0.16066    0.12227   1.314 0.188856    
## V1.x13       0.78768    0.11795   6.678 2.43e-11 ***
## V1.x14       0.07260    0.10874   0.668 0.504380    
## V1.x15       0.05380    0.12258   0.439 0.660701    
## V1.x16       0.27443    0.13654   2.010 0.044448 *  
## V1.x17       0.15745    0.10518   1.497 0.134416    
## V1.x18      -0.02877    0.13462  -0.214 0.830771    
## V1.x19       0.12386    0.12564   0.986 0.324213    
## V1.x20       0.09485    0.14550   0.652 0.514487    
## V1.x21       0.04794    0.15142   0.317 0.751550    
## V1.x22       0.09597    0.13291   0.722 0.470255    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                         edf Ref.df Chi.sq p-value    
## s(latitude,longitude) 36.91     46  193.8  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0158   Deviance explained = 1.87%
## UBRE = -0.0084449  Scale est. = 1         n = 16744</code></pre>
<pre class="r"><code># Now Sparkles emoji
sparky &lt;- grepl(paste(&quot; SPARKLES &quot;), tweets$text)
sparkyDF&lt;-as.data.frame(sparky)
tweets$id &lt;- 1:nrow(tweets)
sparkyDF$id &lt;- 1:nrow(sparkyDF)
tweets &lt;- merge(tweets,sparkyDF,by=&quot;id&quot;)

sparkygam &lt;- gam(I(sparky==&quot;TRUE&quot;)~s(latitude,longitude, k=60) + V1.x, family=binomial, data=tweets)
concurvity(sparkygam)</code></pre>
<pre><code>##               para s(latitude,longitude)
## worst    0.9168534           0.099417003
## observed 0.9168534           0.009350418
## estimate 0.9168534           0.010436183</code></pre>
<pre class="r"><code>gam.check(sparkygam)</code></pre>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 3 iterations.
## Gradient range [7.38181e-08,7.38181e-08]
## (score -0.8937008 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.0003198463,0.0003198463].
## Model rank =  81 / 81 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                           k&#39;    edf k-index p-value
## s(latitude,longitude) 59.000 31.750   0.859    0.14</code></pre>
<pre class="r"><code>summary(sparkygam)</code></pre>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## I(sparky == &quot;TRUE&quot;) ~ s(latitude, longitude, k = 60) + V1.x
## 
## Parametric coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -5.043769   0.308248 -16.363  &lt; 2e-16 ***
## V1.x2        0.374535   0.421174   0.889 0.373860    
## V1.x3        0.521652   0.414222   1.259 0.207903    
## V1.x4        0.540606   0.421866   1.281 0.200031    
## V1.x5       -0.333582   0.542760  -0.615 0.538817    
## V1.x6        0.406962   0.453892   0.897 0.369929    
## V1.x7        0.610551   0.441826   1.382 0.167008    
## V1.x8        0.459427   0.469569   0.978 0.327876    
## V1.x9       -0.006097   0.429996  -0.014 0.988687    
## V1.x10      -0.073187   0.513893  -0.142 0.886751    
## V1.x11      -0.088493   0.588622  -0.150 0.880497    
## V1.x12       0.105301   0.543732   0.194 0.846439    
## V1.x13       1.363123   0.403352   3.379 0.000726 ***
## V1.x14       0.396858   0.430658   0.922 0.356781    
## V1.x15      -0.551737   0.654946  -0.842 0.399555    
## V1.x16      -1.265384   1.047887  -1.208 0.227217    
## V1.x17       0.066183   0.454785   0.146 0.884297    
## V1.x18      -0.010056   0.588844  -0.017 0.986375    
## V1.x19      -0.449025   0.657493  -0.683 0.494648    
## V1.x20       0.043034   0.656281   0.066 0.947718    
## V1.x21      -0.942557   1.047574  -0.900 0.368252    
## V1.x22      -0.214021   0.655523  -0.326 0.744055    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                         edf Ref.df Chi.sq  p-value    
## s(latitude,longitude) 31.75  40.41  86.64 3.35e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0116   Deviance explained = 7.43%
## UBRE = -0.8937  Scale est. = 1         n = 16744</code></pre>
<p><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-56-1.png" width="672" /><img src="/portfolio/2017-05-06-thesis-time_files/figure-html/unnamed-chunk-56-2.png" width="672" /></p>
</div>

         
      </div>
    </div>
  </div>
</div>

          </div>
      </div>
  </div>
  <script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.cookie.js"> </script>
<script src="/js/ekko-lightbox.js"></script>
<script src="/js/jquery.scrollTo.min.js"></script>
<script src="/js/masonry.pkgd.min.js"></script>
<script src="/js/imagesloaded.pkgd.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/front.js"></script>

</body>
</html>
